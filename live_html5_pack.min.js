function CommentFilter(){this.modifiers=[],this.runtime=null,this.allowTypes={1:!0,4:!0,5:!0,6:!0,7:!0,8:!0,17:!0},this.doModify=function(t){for(var e=0;e<this.modifiers.length;e++)t=this.modifiers[e](t);return t},this.beforeSend=function(t){return t},this.doValidate=function(t){return!!this.allowTypes[t.mode]},this.addRule=function(t){},this.addModifier=function(t){this.modifiers.push(t)},this.runtimeFilter=function(t){return null==this.runtime?t:this.runtime(t)},this.setRuntimeFilter=function(t){this.runtime=t}}function isMobile(){var t=!1;return function(e){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0)}(navigator.userAgent||navigator.vendor||window.opera),t}var shield=function(){var t,e=!0,i=1,o=null,n=0,a=!1,s=[],l=function(t){return document.querySelectorAll(t)},r=function(t){return document.querySelector(t)},c=null,d={init:function(i){if(e){void 0!=i&&(c=i),e=!1,shield.tab(0),void 0==localStorage.shieldList&&(localStorage.shieldList='{"text":[],"user":[],"color":[],"useReg":false}'),o=JSON.parse(localStorage.shieldList),void 0==o.color&&(o.color=[]),void 0==o.useReg&&(o.useReg=!1),a=o.useReg,t=o.limit,d.render();var s,h,u;for(u=l(".shield_tab"),s=0,h=u.length;s<h;s++)u[s].tabNum=s,u[s].addEventListener("mouseenter",function(){d.tab(this.tabNum)}),u[s].addEventListener("mouseleave",function(t){var e=this.getBoundingClientRect(),i=t.clientX,o=t.clientY;(i-e.left<0||i-e.left>e.width||o-e.top<0||o-e.top>e.height)&&d.tab(n)}),u[s].addEventListener("click",function(){d.switchTab(this.tabNum)});r(".shield-enrty").addEventListener("click",shield.show),r(".shield .close").addEventListener("click",shield.show),r(".shield .add").addEventListener("click",shield.add),r("#useReg").addEventListener("click",function(){a=!a,d.save(),d.render(3)})}},switchTab:function(t){n=t,r(".shield_body_wrapper").style.transform="translateX("+t*-278+"px)",r(".shield_body_wrapper").style.webkitTransform="translateX("+t*-278+"px)"},tab:function(t){var e=r(".shield"),i=e.getBoundingClientRect(),o=r(".shield .shield_tab:nth-of-type("+(t+1)+")>div").getBoundingClientRect(),n=o.left-i.left,a=o.width,s=r(".shield .shield_tab_slash");s.style.left=n+"px",s.style.width=a+"px"},render:function(t){var e=!0,i=0;for(void 0!=t&&(e=!1,i=t);;){switch(i){case 0:var n,s,c,h="";for(n=0,s=o.text.length;n<s;n++)h+='<div class="shield_item"><div class="text">'+o.text[n]+'</div><div class="delete"></div></div>';for(r("#shield_text").innerHTML=h,c=l("#shield_text .shield_item .delete"),n=0,s=c.length;n<s;n++)c[n].onclick=d.del;break;case 1:for(var c,h="",n=0;n<o.user.length;n++)h+='<div class="shield_item"><div class="text">'+o.user[n]+" mid "+crc_engine(o.user[n])+'</div><div class="delete"></div></div>';for(0==n&&(h='<div class="shield_item">'+ABP.Strings.blockUserEmpty+"</div>"),r("#shield_user").innerHTML=h,c=l("#shield_user .shield_item .delete"),n=0,s=c.length;n<s;n++)c[n].onclick=d.delUser;break;case 2:for(var u,c,h="",n=0;n<o.color.length;n++){for(u=o.color[n].toString(16);u.length<6;)u="0"+u;h+='<div class="shield_color"><div class="color" style="background:#'+u+'">'+o.color[n]+'</div><div class="delete"></div></div>'}for(0==n&&(h='<div class="shield_color">'+ABP.Strings.blockColorEmpty+"</div>"),r("#shield_color").innerHTML=h,c=l("#shield_color .shield_color .delete"),n=0,s=c.length;n<s;n++)c[n].onclick=d.delColor;break;case 3:r("#useReg").className="shield_toggle"+(a?" on":"");break;default:return}i++}},save:function(){o.useReg=a,o.limit=t,localStorage.shieldList=JSON.stringify(o),d.shield()},show:function(){i?l(".shield")[0].setAttribute("class","shield"):l(".shield")[0].setAttribute("class","shield hidden"),i^=1},add:function(){d.addText(r(".shield_item .new").value),r(".shield_item .new").value=""},addText:function(t){return""!=t&&o.text.indexOf(t)==-1&&(o.text.push(t),d.save(),void d.render(0))},addUser:function(t){return o.user.indexOf(t)==-1&&(o.user.push(t),d.save(),void d.render(1))},addColor:function(t){return t=parseInt(t,16),!isNaN(t)&&o.color.indexOf(t)==-1&&(o.color.push(t),d.save(),void d.render(2))},del:function(t){var e,i=t.target.parentNode.childNodes[0].innerHTML,n=o.text.indexOf(i);return n!=-1&&(e=o.text.splice(0,n),o.text=e.concat(o.text.splice(1)),d.save(),void d.render(0))},delUser:function(t){var e,i=t.target.parentNode.childNodes[0].innerHTML.split(" ")[0],n=o.user.indexOf(i);return n!=-1&&(e=o.user.splice(0,n),o.user=e.concat(o.user.splice(1)),d.save(),void d.render(1))},delColor:function(t){var e,i=t.target.parentNode.childNodes[0].innerHTML,n=o.color.indexOf(1*i);return n!=-1&&(e=o.color.splice(0,n),o.color=e.concat(o.color.splice(1)),d.save(),void d.render(2))},filterChk:function(t){var e;if(o.color.indexOf(t.color)!=-1||o.user.indexOf(t.hash)!=-1)return!1;for(e=0;e<s.length;e++)try{if(null!=t.text.match(s[e]))return!1}catch(t){}return!0},filter:function(t){return!!shield.filterChk(t)&&(t.filtered||(t.oriSize=t.size,t.filtered=!0),t.size=t.oriSize*abpinst.commentScale,t)},shield:function(){s=[];var t,e,i,n=c.cmManager.runline;for(e=0;e<o.text.length;e++)s.push(a?new RegExp(o.text[e]):o.text[e]);for(t=0;t<n.length;t++)if(i=n[t],o.color.indexOf(i.color)!=-1||o.user.indexOf(i.originalData.hash)!=-1)i.finish(),t--;else for(e=0;e<s.length;e++)if(null!=i.text.match(e)){i.finish(),t--;break}}};return d}();window.shield=shield,unsafeWindow.shield=shield;var BinArray=function(){var t={};return t.bsearch=function(t,e,i){if(0===t.length)return 0;if(i(e,t[0])<0)return 0;if(i(e,t[t.length-1])>=0)return t.length;for(var o=0,n=0,a=0,s=t.length-1;o<=s;){if(n=Math.floor((s+o+1)/2),a++,i(e,t[n-1])>=0&&i(e,t[n])<0)return n;i(e,t[n-1])<0?s=n-1:i(e,t[n])>=0?o=n:console.error("Program Error"),a>1500&&console.error("Too many run cycles.")}return-1},t.binsert=function(e,i,o){var n=t.bsearch(e,i,o);return e.splice(n,0,i),n},t}(),__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},CommentSpaceAllocator=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._pools=[[]],this.avoid=1,this._width=t,this._height=e}return t.prototype.willCollide=function(t,e){return t.stime+t.ttl>=e.stime+e.ttl/2},t.prototype.pathCheck=function(t,e,i){for(var o=t+e.height,n=e.right,a=0;a<i.length;a++)if(!(i[a].y>o||i[a].bottom<t)){if(!(i[a].right<e.x||i[a].x>n))return!1;if(this.willCollide(i[a],e))return!1}return!0},t.prototype.assign=function(t,e){for(;this._pools.length<=e;)this._pools.push([]);var i=this._pools[e];if(0===i.length)return t.cindex=e,0;if(this.pathCheck(0,t,i))return t.cindex=e,0;for(var o=0,n=0;n<i.length&&(o=i[n].bottom+this.avoid,!(o+t.height>this._height));n++)if(this.pathCheck(o,t,i))return t.cindex=e,o;return this.assign(t,e+1)},t.prototype.add=function(t){t.height>this._height?(t.cindex=-2,t.y=0):(t.y=this.assign(t,0),BinArray.binsert(this._pools[t.cindex],t,function(t,e){return t.bottom<e.bottom?-1:t.bottom>e.bottom?1:0}))},t.prototype.remove=function(t){if(!(t.cindex<0)){if(t.cindex>=this._pools.length)throw new Error("cindex out of bounds");var e=this._pools[t.cindex].indexOf(t);e<0||this._pools[t.cindex].splice(e,1)}},t.prototype.setBounds=function(t,e){this._width=t,this._height=e},t}(),AnchorCommentSpaceAllocator=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.add=function(e){t.prototype.add.call(this,e),e.x=(this._width-e.width)/2},e.prototype.willCollide=function(t,e){return!0},e.prototype.pathCheck=function(t,e,i){for(var o=t+e.height,n=0;n<i.length;n++)if(!(i[n].y>o||i[n].bottom<t))return!1;return!0},e}(CommentSpaceAllocator),CoreComment=function(){function t(e,i){if(void 0===i&&(i={}),this.mode=1,this.stime=0,this.text="",this.ttl=4e3,this.dur=4e3,this.cindex=-1,this.motion=[],this.movable=!0,this._alphaMotion=null,this.absolute=!0,this.align=0,this._alpha=1,this._size=25,this._color=16777215,this._border=!1,this._shadow=!0,this._font="",!e)throw new Error("Comment not bound to comment manager.");if(this.parent=e,i.hasOwnProperty("stime")&&(this.stime=i.stime),i.hasOwnProperty("mode")?this.mode=i.mode:this.mode=1,i.hasOwnProperty("dur")&&(this.dur=i.dur,this.ttl=this.dur),this.dur*=this.parent.options.global.scale,this.ttl*=this.parent.options.global.scale,4!==this.mode&&5!==this.mode||(this.dur*=.6,this.ttl*=.6),i.hasOwnProperty("text")&&(this.text=i.text),i.hasOwnProperty("motion")){this._motionStart=[],this._motionEnd=[],this.motion=i.motion;for(var o=0,n=0;n<i.motion.length;n++){this._motionStart.push(o);var a=0;for(var s in i.motion[n]){var l=i.motion[n][s];a=Math.max(l.dur,a),null!==l.easing&&void 0!==l.easing||(i.motion[n][s].easing=t.LINEAR)}o+=a,this._motionEnd.push(o)}this._curMotion=0}i.hasOwnProperty("color")&&(this._color=i.color),i.hasOwnProperty("size")&&(this._size=i.size),i.hasOwnProperty("border")&&(this._border=i.border),i.hasOwnProperty("opacity")&&(this._alpha=i.opacity),i.hasOwnProperty("alpha")&&(this._alphaMotion=i.alpha),i.hasOwnProperty("font")&&(this._font=i.font),i.hasOwnProperty("x")&&(this._x=i.x),i.hasOwnProperty("y")&&(this._y=i.y),i.hasOwnProperty("shadow")&&(this._shadow=i.shadow),i.hasOwnProperty("position")&&"relative"===i.position&&(this.absolute=!1,this.mode<7&&console.warn("Using relative position for CSA comment."))}return t.prototype.init=function(t){void 0===t&&(t=null),null!==t?this.dom=t.dom:this.dom=document.createElement("div"),this.dom.className=this.parent.options.global.className,this.dom.appendChild(document.createTextNode(this.text)),this.dom.textContent=this.text,this.dom.innerText=this.text,this.size=this._size,16777215!=this._color&&(this.color=this._color),this.shadow=this._shadow,this._border&&(this.border=this._border),""!==this._font&&(this.font=this._font),void 0!==this._x&&(this.x=this._x),void 0!==this._y&&(this.y=this._y),(1!==this._alpha||this.parent.options.global.opacity<1)&&(this.alpha=this._alpha),this.motion.length>0&&this.animate()},Object.defineProperty(t.prototype,"x",{get:function(){return null!==this._x&&void 0!==this._x||(this.align%2===0?this._x=this.dom.offsetLeft:this._x=this.parent.width-this.dom.offsetLeft-this.width),this.absolute?this._x:this._x/this.parent.width},set:function(t){this._x=t,this.absolute||(this._x*=this.parent.width),this.align%2===0?this.dom.style.left=this._x+"px":this.dom.style.right=this._x+"px"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return null!==this._y&&void 0!==this._y||(this.align<2?this._y=this.dom.offsetTop:this._y=this.parent.height-this.dom.offsetTop-this.height),this.absolute?this._y:this._y/this.parent.height},set:function(t){this._y=t,this.absolute||(this._y*=this.parent.height),this.align<2?this.dom.style.top=this._y+"px":this.dom.style.bottom=this._y+"px"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return null!==this._width&&void 0!==this._width||(this._width=this.dom.offsetWidth),this._width},set:function(t){this._width=t,this.dom.style.width=this._width+"px"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return null!==this._height&&void 0!==this._height||(this._height=this.dom.offsetHeight),this._height},set:function(t){this._height=t,this.dom.style.height=this._height+"px"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._size},set:function(t){this._size=t,this.dom.style.fontSize=this._size+"px"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this._color},set:function(t){this._color=t;var e=t.toString(16);e=e.length>=6?e:new Array(6-e.length+1).join("0")+e,this.dom.style.color="#"+e,0===this._color&&(this.dom.className=this.parent.options.global.className+" rshadow")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha=t,this.dom.style.opacity=Math.min(this._alpha,this.parent.options.global.opacity)+""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"border",{get:function(){return this._border},set:function(t){this._border=t,this._border?this.dom.style.border="1px solid #00ffff":this.dom.style.border="none"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shadow",{get:function(){return this._shadow},set:function(t){this._shadow=t,this._shadow||(this.dom.className=this.parent.options.global.className+" noshadow")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"font",{get:function(){return this._font},set:function(t){this._font=t,this._font.length>0?this.dom.style.fontFamily=this._font:this.dom.style.fontFamily=""},enumerable:!0,configurable:!0}),t.prototype.time=function(t){this.ttl-=t,this.ttl<0&&(this.ttl=0),this.movable&&this.update(),this.ttl<=0&&this.finish()},t.prototype.update=function(){this.animate()},t.prototype.invalidate=function(){this._x=null,this._y=null,this._width=null,this._height=null},t.prototype._execMotion=function(t,e){for(var i in t)if(t.hasOwnProperty(i)){var o=t[i];this[i]=o.easing(Math.min(Math.max(e-o.delay,0),o.dur),o.from,o.to-o.from,o.dur)}},t.prototype.animate=function(){if(this._alphaMotion&&(this.alpha=(this.dur-this.ttl)*(this._alphaMotion.to-this._alphaMotion.from)/this.dur+this._alphaMotion.from),0!==this.motion.length){var t=Math.max(this.ttl,0),e=this.dur-t-this._motionStart[this._curMotion];return this._execMotion(this.motion[this._curMotion],e),this.dur-t>this._motionEnd[this._curMotion]?(this._curMotion++,void(this._curMotion>=this.motion.length&&(this._curMotion=this.motion.length-1))):void 0}},t.prototype.stop=function(){},t.prototype.finish=function(){this.parent.finish(this)},t.prototype.toString=function(){return["[",this.stime,"|",this.ttl,"/",this.dur,"]","(",this.mode,")",this.text].join("")},t.LINEAR=function(t,e,i,o){return t*i/o+e},t}(),ScrollComment=function(t){function e(e,i){t.call(this,e,i),this.dur*=this.parent.options.scroll.scale,this.ttl*=this.parent.options.scroll.scale}return __extends(e,t),Object.defineProperty(e.prototype,"alpha",{set:function(t){this._alpha=t,this.dom.style.opacity=Math.min(Math.min(this._alpha,this.parent.options.global.opacity),this.parent.options.scroll.opacity)+""},enumerable:!0,configurable:!0}),e.prototype.init=function(e){void 0===e&&(e=null),t.prototype.init.call(this,e),this.x=this.parent.width,this.parent.options.scroll.opacity<1&&(this.alpha=this._alpha),this.absolute=!0},e.prototype.update=function(){this.x=this.ttl/this.dur*(this.parent.width+this.width)-this.width},e}(CoreComment),CSSCompatLayer=function(){function t(){}return t.transform=function(t,e){t.style.transform=e,t.style.webkitTransform=e,t.style.msTransform=e,t.style.oTransform=e},t}(),CSSScrollComment=function(t){function e(){t.apply(this,arguments),this._dirtyCSS=!0}return __extends(e,t),Object.defineProperty(e.prototype,"x",{get:function(){return this.ttl/this.dur*(this.parent.width+this.width)-this.width},set:function(t){if("number"==typeof this._x){var e=t-this._x;this._x=t,CSSCompatLayer.transform(this.dom,"translateX("+e+"px)")}else this._x=t,this.absolute||(this._x*=this.parent.width),this.align%2===0?this.dom.style.left=this._x+"px":this.dom.style.right=this._x+"px"},enumerable:!0,configurable:!0}),e.prototype.update=function(){this._dirtyCSS&&(this.dom.style.transition="transform "+this.ttl+"ms linear",this.x=-this.width,this._dirtyCSS=!1)},e.prototype.invalidate=function(){t.prototype.invalidate.call(this),this._dirtyCSS=!0},e.prototype.stop=function(){this.dom.style.transition="",this.x=this._x,this._x=null,this.x=this.ttl/this.dur*(this.parent.width+this.width)-this.width,this._dirtyCSS=!0},e}(ScrollComment),CommentManager=function(){function t(t){var e=0,o=this;this._listeners={},this._lastPosition=0,this.stage=t,this.paused=!0,this.pausedTime=0,this.canvas=document.createElement("canvas"),this.canvasStatic=document.createElement("canvas"),this.staticUpdate=!1,this.canvasFPS=0,o.canvas.style.width="100%",o.canvas.style.height="100%",o.stage.appendChild(o.canvas),o.canvasStatic.style.width="100%",o.canvasStatic.style.height="100%",o.canvasStatic.style.position="absolute",o.canvasStatic.style.top=0,o.canvasStatic.style.left=0,o.stage.appendChild(o.canvasStatic),this.options={global:{opacity:1,scale:1,className:"cmt",useCSS:!1,autoOpacity:!1,autoOpacityVal:1},scroll:{opacity:1,scale:1},limit:0},this.timeline=[],this.runline=[],this.position=0,this.limiter=0,this.filter=null,this.csa={scroll:new CommentSpaceAllocator(0,0),top:new AnchorCommentSpaceAllocator(0,0),bottom:new AnchorCommentSpaceAllocator(0,0),reverse:new CommentSpaceAllocator(0,0),scrollbtm:new CommentSpaceAllocator(0,0)},this.width=this.stage.offsetWidth,this.height=this.stage.offsetHeight;var n=0;this.startTimer=function(){if(!(e>0)){var t=(new Date).getTime(),i=this;e=window.setInterval(function(){var e=(new Date).getTime()-t;t=(new Date).getTime(),i.onTimerEvent(e,i),i.sendQueueLoader()},1e3/60),this.paused=!1,this.pausedTime=Date.now()-n}},this.stopTimer=function(){window.clearInterval(e),e=0,this.paused=!0,n=Date.now()};var a=(this.options.global.opacity,!1),s=0,l=0,r=function(){o.options.global.autoOpacity&&(o.options.global.useCSS?o.stage.style.opacity=i(l):o.options.global.autoOpacityVal=o.options.global.opacity*i(l))};setInterval(function(){o.canvasFPS=s,s=0},1e3),this.addEventListener("enterComment",function(){l++,r()}),this.addEventListener("exitComment",function(){l--,r()}),this.canvasDrawerWrapper=function(t){a||(t||(t=performance.now()),a=!0,s++,o.canvasDrawer(0|t),a=!1)},this.ttlRecalcAll=function(){this.runline.forEach(c)};var h=[];this.send=function(t){h.push(t)},this.sendQueueLoader=function(){for(var t,e=performance.now();h.length>0;)if(o.sendAsync(h.shift()),t=performance.now()-e,t>8)return},this.addEventListener("clear",function(){h=[]}),requestAnimationFrame(this.canvasDrawerWrapper),function(){var t=window.devicePixelRatio;window.addEventListener("resize",function(){var e=window.devicePixelRatio;t!=e&&(o.runline.forEach(function(t){t.textData&&d(t)}),t=e),o.ttlRecalcAll()})}()}var e=function(t,e){for(var i=Math.PI/180,o=t*i,n=e*i,a=Math.cos,s=Math.sin,l=[a(o)*a(n),a(o)*s(n),s(o),0,-s(n),a(n),0,0,-s(o)*a(n),-s(o)*s(n),a(o),0,0,0,0,1],r=0;r<l.length;r++)Math.abs(l[r])<1e-6&&(l[r]=0);return"matrix3d("+l.join(",")+")"},i=function(t){return-Math.tanh((t-50)/25)/Math.PI*.8+.718},o="-apple-system,Arial,'PingFang SC','STHeiti Light','Hiragino Kaku Gothic ProN','Microsoft YaHei'";t.prototype.stop=function(){this.stopTimer();for(var t=0;t<this.runline.length;t++)"undefined"!=typeof this.runline[t].stop&&this.runline[t].stop()},t.prototype.start=function(){this.startTimer()},t.prototype.seek=function(t){this.position=BinArray.bsearch(this.timeline,t,function(t,e){return t<e.stime?-1:t>e.stime?1:0})},t.prototype.validate=function(t){return null!=t&&this.filter.doValidate(t)},t.prototype.load=function(t){this.timeline=t,this.timeline.sort(function(t,e){return t.stime>e.stime?2:t.stime<e.stime?-2:t.date>e.date?1:t.date<e.date?-1:null!=t.dbid&&null!=e.dbid?t.dbid>e.dbid?1:t.dbid<e.dbid?-1:0:0}),this.dispatchEvent("load")},t.prototype.insert=function(t){var e=BinArray.binsert(this.timeline,t,function(t,e){return t.stime>e.stime?2:t.stime<e.stime?-2:t.date>e.date?1:t.date<e.date?-1:null!=t.dbid&&null!=e.dbid?t.dbid>e.dbid?1:t.dbid<e.dbid?-1:0:0});e<=this.position&&this.position++,this.dispatchEvent("insert")},t.prototype.clear=function(){for(;this.runline.length>0;)this.runline[0].finish();this.dispatchEvent("clear"),this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height),this.canvasStatic.getContext("2d").clearRect(0,0,this.canvasStatic.width,this.canvasStatic.height)},t.prototype.setBounds=function(){this.width=this.stage.offsetWidth,this.height=this.stage.offsetHeight,this.dispatchEvent("resize");for(var t in this.csa)this.csa[t].setBounds(this.width,this.height);this.stage.style.perspective=this.width*Math.tan(40*Math.PI/180)/2+"px",this.stage.style.webkitPerspective=this.width*Math.tan(40*Math.PI/180)/2+"px"},t.prototype.init=function(){this.setBounds(),null==this.filter&&(this.filter=new CommentFilter)},t.prototype.time=function(t){if(t-=1,this.position>=this.timeline.length||Math.abs(this._lastPosition-t)>=2e3){if(this.seek(t),this._lastPosition=t,this.timeline.length<=this.position)return}else this._lastPosition=t;for(;this.position<this.timeline.length&&this.timeline[this.position].stime<=t;this.position++)this.options.limit>0&&this.runline.length>this.limiter||this.validate(this.timeline[this.position])&&this.send(this.timeline[this.position])},t.prototype.canvasResize=function(){try{var t=(this.width,this.height,window.devicePixelRatio);this.canvas.width=this.canvas.offsetWidth*t,this.canvasStatic.height=this.canvasStatic.offsetHeight*t,this.ttlRecalcAll(),n(this),a(this)}catch(t){return console.error("shit happened! forcing CSS! ",t.message),void this.useCSS(!0)}};var n=function(t){var e,i,o,n,a=t.canvasStatic,s=a.getContext("2d"),r=window.devicePixelRatio,c=t.height,d=[0];t.runline.forEach(function(t){[4,5].indexOf(t.mode)!=-1&&d.push(t._width)}),d=Math.min(t.width,Math.max.apply(Math,d)),e=d,n=(t.width-d)/2,d!=a.offsetWidth?(a.style.width=d+"px",a.style.left="calc(50% - "+d/2+"px)",a.width=d*r):s.clearRect(0,0,e*r,c*r),s.globalAlpha=t.options.global.autoOpacity?t.options.global.autoOpacityVal:t.options.global.opacity,t.runline.forEach(function(t){if(t.textData){switch(t.mode){case 4:t.x=(e-t.width)/2+n,i=t.x-n,o=c-t.y-t.height;break;case 5:t.x=(e-t.width)/2+n,i=t.x-n,o=t.y;break;default:return}s.drawImage(t.textData,l(i*r),l(o*r))}})},a=function(t){var e,i,o,n=t.canvas,a=n.getContext("2d"),s=window.devicePixelRatio,r=t.width,c=[0];t.runline.forEach(function(t){1==t.mode&&c.push(t._y+t._height)}),c=Math.max.apply(Math,c),e=c,n.offsetHeight!=c?(n.style.height=c+"px",n.height=c*s):a.clearRect(0,0,r*s,e*s),a.globalAlpha=t.options.global.autoOpacity?t.options.global.autoOpacityVal:t.options.global.opacity,t.runline.forEach(function(t){if(t.textData){switch(t.mode){case 1:t.x=r-t.rx,i=r-t.rx,o=t.y;break;default:return}a.drawImage(t.textData,l(i*s),l(o*s))}})};t.prototype.canvasDrawer=function(){if(!this.options.global.useCSS){if(this.paused)return void requestAnimationFrame(this.canvasDrawerWrapper);var t=0|performance.now(),e=window.devicePixelRatio,i=this.pausedTime,o=this.canvas.getContext("2d"),s=this.width,l=this.height;o.clearRect(0,0,s*e,l*e),o.globalAlpha=this.options.global.autoOpacity?this.options.global.autoOpacityVal:this.options.global.opacity,o.imageSmoothingEnabled=!1,0!=i&&(this.runline.forEach(function(t){if(t.textData)switch(t.mode){case 1:t.prev+=i;break;case 4:case 5:t.removeTime+=i}}),this.pausedTime=0),this.runline.forEach(function(e){if(e.textData)switch(e.mode){case 1:e.rx+=e.speed*(t-e.prev)/1e3,e.prev=t}}),this.staticUpdate&&(n(this),this.staticUpdate=!1),a(this),requestAnimationFrame(this.canvasDrawerWrapper)}};var s=Math.ceil,l=Math.round,r=function(t){for(var t=t.toString(16);t.length<6;)t="0"+t;return t},c=function(t){if(t.speed){var e=t.dur-t.ttl;t.dur=(t.parent.width+t.width)/t.speed*1e3,t.ttl=t.dur-e}},d=function(t){var e=document.createElement("canvas"),i=e.getContext("2d"),n=window.devicePixelRatio;i.font=t.size*n+"px "+o,i.imageSmoothingEnabled=!1,t.width=s(i.measureText(t.text).width/n)+2,t.height=s(t.size+3)+2,t.oriWidth=s(t.width*n),t.oriHeight=s(t.height*n),e.width=t.oriWidth,e.height=t.oriHeight,i.font=t.size*n+"px "+o,i.lineWidth=l(1*n),i.strokeStyle=0==t._color?"#FFFFFF":"#000000",i.textBaseline="bottom",i.textAlign="left",i.shadowBlur=l(2*n),i.shadowColor=0==t._color?"#FFFFFF":"#000000",i.fillStyle="#"+r(t.color),i.strokeText(t.text,1,e.height-1),i.fillText(t.text,1,e.height-1),t.border&&(i.lineWidth=l(2*n),i.strokeStyle="#00ffff",i.shadowBlur=0,i.strokeRect(0,0,e.width,e.height)),t.textData=e};return t.prototype.getCommentFromPoint=function(t,e){var i,o,n=[],a=this.height;return this.runline.forEach(function(s){i=t-s.x,o=4==s.mode?e-(a-s.y-s.height):e-s.y,i>=0&&i<=s.width&&o>=0&&o<=s.height&&n.push(s)}),n},t.prototype.useCSS=function(t){this.options.global.useCSS=t,this.clear(),t||(this.stage.style.opacity="",requestAnimationFrame(this.canvasDrawerWrapper))},t.prototype.autoOpacity=function(t){this.options.global.autoOpacity=t},t.prototype.sendAsync=function(t){if(8===t.mode)return console.log(t),void(this.scripting&&console.log(this.scripting.eval(t.code)));if(null==this.filter||(t=this.filter.doModify(t),null!=t&&t!==!1)){if(this.options.global.useCSS||[1,4,5].indexOf(t.mode)==-1){if(1===t.mode||2===t.mode||6===t.mode)var i=new CSSScrollComment(this,t);else var i=new CoreComment(this,t);switch(i.mode){case 1:i.align=0;break;case 2:i.align=2;break;case 4:i.align=2;break;case 5:i.align=0;break;case 6:i.align=1}switch(i.init(),this.stage.appendChild(i.dom),i.dom.transitionStartTime=(new Date).getTime(),i.mode){default:case 1:this.csa.scroll.add(i);break;case 2:this.csa.scrollbtm.add(i);break;case 4:this.csa.bottom.add(i);break;case 5:this.csa.top.add(i);break;case 6:this.csa.reverse.add(i);break;case 17:case 7:0===t.rY&&0===t.rZ||(i.dom.style.transform=e(t.rY,t.rZ),i.dom.style.webkitTransform=e(t.rY,t.rZ),i.dom.style.OTransform=e(t.rY,t.rZ),i.dom.style.MozTransform=e(t.rY,t.rZ),i.dom.style.MSTransform=e(t.rY,t.rZ))}i.y=i.y}else{var o=performance.now(),i=new CoreComment(this,t);switch(i.dom={style:{}},d(i),1==t.mode||6==t.mode?(i.rx=0,i.x=this.width,i.prev=o,i.speed=(this.width+i.width)/i.dur*1e3):4!=t.mode&&5!=t.mode||(i.removeTime=o+i.dur),i.mode){default:case 1:this.csa.scroll.add(i);break;case 4:this.csa.bottom.add(i),this.staticUpdate=!0;break;case 5:this.csa.top.add(i),this.staticUpdate=!0}}i.originalData=t,this.dispatchEvent("enterComment",i),this.runline.push(i)}},t.prototype.finish=function(t){this.dispatchEvent("exitComment",t);try{this.stage.removeChild(t.dom)}catch(t){}var e=this.runline.indexOf(t);switch(e>=0&&this.runline.splice(e,1),t.mode){default:case 1:this.csa.scroll.remove(t);break;case 2:this.csa.scrollbtm.remove(t);break;case 4:this.csa.bottom.remove(t),this.staticUpdate=!0;break;case 5:this.csa.top.remove(t),this.staticUpdate=!0;break;case 6:this.csa.reverse.remove(t);break;case 7:}t.textData&&(t.textData=null)},t.prototype.resumeComment=function(){Array.prototype.slice.call(this.stage.children).forEach(function(t){t.classList.contains("cmt")&&t.classList.contains("paused")&&(t.style.transitionDuration=t.finalDuration+"ms",t.style.transform=t.finalTransform,t.transitionStartTime=(new Date).getTime(),t.classList.remove("paused"))})},t.prototype.pauseComment=function(){Array.prototype.slice.call(this.stage.children).forEach(function(t){t.classList.contains("cmt")&&!t.classList.contains("paused")&&(t.finalTransform=t.style.transform,t.style.transform=window.getComputedStyle(t).getPropertyValue("transform"),t.finalDuration=parseFloat(t.style.transitionDuration)-(new Date).getTime()+t.transitionStartTime,t.style.transitionDuration="10ms",t.classList.add("paused"))})},t.prototype.addEventListener=function(t,e){"undefined"!=typeof this._listeners[t]?this._listeners[t].push(e):this._listeners[t]=[e]},t.prototype.dispatchEvent=function(t,e){if("undefined"!=typeof this._listeners[t])for(var i=0;i<this._listeners[t].length;i++)try{this._listeners[t][i](e)}catch(t){console.err(t.stack)}},t.prototype.onTimerEvent=function(t,e){for(var i=0;i<e.runline.length;i++){var o=e.runline[i];o.hold||o.time(t)}},t}(),ABP={version:"0.8.0",Strings:{statsPlayer:"播放器尺寸：",statsVideo:"视频分辨率：",statsBuffer:"可用缓冲：",statsBufferClip:"缓冲片段：",statsPresent:"期望帧率：",statsDrop:"丢弃帧率：",statsVideoCodec:"视频编码：",statsAudioCodec:"音频编码：",statsVideoBitrate:"视频码率：",statsAudioBitrate:"音频码率：",statsCurrentBitrate:"本段码率：",statsRealtimeBitrate:"实时码率：",overallBitrate:"总体码率：",statsDownloadSpeed:"下载速度：",sendSmall:"小字号",sendMid:"中字号",sendSize:"弹幕字号",sendMode:"弹幕模式",sendTop:"顶端渐隐",sendScroll:"滚动字幕",sendBottom:"底端渐隐",send:"发送",sendStyle:"弹幕样式",sendColor:"弹幕颜色",commentSpeed:"弹幕速度",commentScale:"弹幕比例",commentOpacity:"弹幕不透明度",commentBlock:"弹幕屏蔽列表",playSpeed:"播放速度",playSpeedReset:"还原正常速度",displayScaleD:"默认",displayScaleF:"全屏",shieldTypeText:"文字",shieldTypeUser:"用户",shieldTypeColor:"颜色",shieldTypeSetting:"设置",shieldAdd:"添加屏蔽……",shieldUseRegex:"启用正则",viewers:" 观众",comments:" 弹幕",commentTime:"时间",commentContent:"评论",commentDate:"发送日期",showStats:"显示统计信息",loadingMeta:"正在加载视频信息",switching:"正在切换",fetchURL:"正在获取视频地址",buffering:"正在缓冲",play:"播放",pause:"暂停",mute:"静音",unmute:"取消静音",fullScreen:"浏览器全屏",exitFullScreen:"退出全屏",webFull:"网页全屏",exitWebFull:"退出网页全屏",wideScreen:"宽屏模式",exitWideScreen:"退出宽屏",sendTooltip:"毁灭地喷射白光!da!",showComment:"显示弹幕",hideComment:"隐藏弹幕",loopOn:"洗脑循环 on",loopOff:"重新载入",usingCanvas:"正在使用Canvas",usingCSS:"正在使用CSS",useCSS:"使用CSS绘制弹幕",autoOpacityOn:"关闭自动不透明度",autoOpacityOff:"开启自动不透明度",copyComment:"复制弹幕",findComment:"定位弹幕",blockContent:"屏蔽内容“",blockUser:"屏蔽发送者",blockColor:"屏蔽颜色",blockColorWhite:"不能屏蔽白色",copyFail:"复制失败，浏览器不支持",blockUserEmpty:"没有屏蔽用户",blockColorEmpty:"没有屏蔽颜色"}};(function(){"use strict";if(ABP){var t=jQuery,e="addEventListener",i="HTML5 Player ver.171229 based on ABPlayer-bilibili-ver",o=function(t){return document.getElementById(t)},n=function(t,e,i,o){var n=null;if("text"===t)return document.createTextNode(e);n=document.createElement(t);for(var a in e)if("style"!==a&&"className"!==a)n.setAttribute(a,e[a]);else if("className"===a)n.className=e[a];else for(var s in e.style)n.style[s]=e.style[s];if(i)for(var l=0;l<i.length;l++)null!=i[l]&&n.appendChild(i[l]);return o&&"function"==typeof o&&o(n),n},a=function(t,e){for(;t;t=t.parentNode)if(p(t.parentNode,e))return t};HTMLElement.prototype.tooltip=function(t){this.tooltipData=t,this.dispatchEvent(new Event("updatetooltip"))},"undefined"==typeof HTMLElement.prototype.requestFullScreen&&(HTMLElement.prototype.requestFullScreen=function(){
this.webkitRequestFullscreen?this.webkitRequestFullscreen():this.mozRequestFullScreen?this.mozRequestFullScreen():this.msRequestFullscreen&&this.msRequestFullscreen()});var s=Object.keys(HTMLVideoElement.prototype);s.indexOf("webkitDecodedFrameCount")!=-1&&s.indexOf("getVideoPlaybackQuality")==-1&&(HTMLVideoElement.prototype.getVideoPlaybackQuality=function(){return{totalVideoFrames:this.webkitDecodedFrameCount,droppedVideoFrames:this.webkitDroppedFrameCount}}),"undefined"==typeof document.isFullScreen&&(document.isFullScreen=function(){return document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenEnabled}),"undefined"==typeof document.exitFullscreen&&(document.exitFullscreen=function(){document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():window.msExitFullscreen&&msExitFullscreen()});var l=function(t,e){e=e||2;for(var i=""+t;i.length<e;)i="0"+i;return i},r=function(t,e){for(var i="",o=1;o<=e-(t+"").length;o++)i+="0";return i+t},c=function(t,e){if(0==t)return lang.oneDay;var i,o,n,a,s,l,r=new Date(1e3*parseInt(t));return i=String(r.getFullYear()),o=String(r.getMonth()+1),1==o.length&&(o="0"+o),n=String(r.getDate()),1==n.length&&(n="0"+n),a=String(r.getHours()),1==a.length&&(a="0"+a),s=String(r.getMinutes()),1==s.length&&(s="0"+s),l=String(r.getSeconds()),1==l.length&&(l="0"+l),e?String(o+"-"+n+" "+a+":"+s):String(i+"-"+o+"-"+n+" "+a+":"+s+":"+l)},d=function(t){return isNaN(t)?"00:00":r(parseInt(t/60),2)+":"+r(parseInt(t%60),2)},h=function(t){for(var e=t.split(":"),i=0,o=0;o<e.length;o++){i*=60;var n=parseInt(e[o]);if(isNaN(n)||n<0)return!1;i+=n}return i},u=function(t,i,s){t&&(t[e]("mousemove",function(e){var l,r=o("ABP-Tooltip"),c=t.clientWidth,d=t.clientHeight,h=t.getBoundingClientRect(),u=a(t,"ABP-Unit").getBoundingClientRect(),m=h.top-u.top,p=i?e.clientX-u.left:h.left-u.left,f=p;null==r&&(r=n("div",{id:"ABP-Tooltip"},[n("text",t.tooltipData)]),r.by=t,a(t,"ABP-Unit").appendChild(r),r.style.top=m+d+2+"px",r.style.left=p+c/2-r.clientWidth/2+"px",f+=c/2-r.clientWidth/2),i&&(r.style.left=p-r.clientWidth/2+"px",f-=c/2),l=r.getBoundingClientRect(),l.left<u.left?r.style.left="0px":l.right>u.right&&(r.style.left=u.width-l.width+"px"),s=s||-6,s&&(r.style.top=m-r.clientHeight+2+s+"px")}),t[e]("mouseout",function(){var t=o("ABP-Tooltip");t&&t.parentNode&&t.parentNode.removeChild(t)}),t[e]("updatetooltip",function(e){var i=o("ABP-Tooltip");i&&i.by==e.target&&(i.innerHTML=t.tooltipData)}))},m=function(t,e){if(null!=t){var i=t.className.split(" ");""==i[0]&&(i=[]),i.indexOf(e)<0&&i.push(e),t.className=i.join(" ")}},p=function(t,e){if(null==t)return!1;var i=t.className.split(" ");return""==i[0]&&(i=[]),i.indexOf(e)>=0},f=function(t,e){if(null!=t){var i=t.className.split(" ");""==i[0]&&(i=[]),i.indexOf(e)>=0&&i.splice(i.indexOf(e),1),t.className=i.join(" ")}},v=function(t,e){var i={};for(var o in e)t&&"undefined"!=typeof t[o]?i[o]=t[o]:i[o]=e[o];return i};ABP.create=function(t,a){var s=t;if(a||(a={}),ABP.playerConfig=a.config?a.config:{},a=v(a,{replaceMode:!0,width:512,height:384,src:""}),"string"==typeof t&&(s=o(t)),p(s,"ABP-Unit"))l=s;else{var l=n("div",{className:"ABP-Unit",theme:"YouTube",style:{width:a.width.toString().indexOf("%")>=0?a.width:a.width+"px",height:a.height.toString().indexOf("%")>=0?a.height:a.height+"px"}});s.appendChild(l)}l.children.length>0&&a.replaceMode&&(l.innerHTML="");var r=[],c=[];if("string"==typeof a.src)a.src=n("video",{autobuffer:"true",dataSetup:"{}"},[n("source",{src:a.src})]),r.push(a.src);else if(a.src.hasOwnProperty("playlist"))for(var d=a.src,h=d.playlist,u=0;u<h.length;u++){if(h[u].hasOwnProperty("sources")){var m=[];for(var f in h[u].sources)m.push(n("source",{src:h[u][f],type:f}));r.push(n("video",{autobuffer:"true",dataSetup:"{}"},m))}else h[u].hasOwnProperty("video")&&r.push(h[u].video);c.push(h[u].comments)}else r.push(a.src);l.appendChild(n("div",{className:"ABP-Player"},[n("div",{className:"ABP-Video",tabindex:"10"},[n("div",{id:"info-box",style:{opacity:1}},[n("div",{className:"text-wrapper"},[n("div",{},[n("text",ABP.Strings.loadingMeta)])]),n("div",{id:"dots"})]),n("div",{className:"ABP-Container"}),r[0],n("div",{className:"Player-Stats"},[n("div",{id:"player-dimension"},[n("span",{className:"stats_name"},[n("text",ABP.Strings.statsPlayer)]),n("span")]),n("div",{id:"video-dimension"},[n("span",{className:"stats_name"},[n("text",ABP.Strings.statsVideo)]),n("span")]),n("div",{id:"buffer-health"},[n("span",{className:"stats_name"},[n("text",ABP.Strings.statsBuffer)]),n("span",{className:"stats-column",id:"buffer-health-column"}),n("span")]),n("br",{className:"flvjs"}),n("div",{className:"flvjs"},[n("span",{className:"stats_name"},[n("text",ABP.Strings.statsVideoCodec)]),n("span")]),n("div",{className:"flvjs"},[n("span",{className:"stats_name"},[n("text",ABP.Strings.statsAudioCodec)]),n("span")]),n("div",{className:"flvjs"},[n("span",{className:"stats_name"},[n("text","fps：")]),n("span")]),n("div",{className:"flvjs",title:"1 kbps = 1000 bps"},[n("span",{className:"stats_name"},[n("text",ABP.Strings.statsVideoBitrate)]),n("span")]),n("div",{className:"flvjs",title:"1 kbps = 1000 bps"},[n("span",{className:"stats_name"},[n("text",ABP.Strings.statsAudioBitrate)]),n("span")]),n("div",{className:"flvjs",title:"1 kbps = 1000 bps"},[n("span",{className:"stats_name"},[n("text",ABP.Strings.statsRealtimeBitrate)]),n("span",{className:"stats-column",id:"realtime-bitrate-column",style:{verticalAlign:"top"}}),n("span")]),n("div",{className:"flvjs"},[n("span",{className:"stats_name"},[n("text",ABP.Strings.statsDownloadSpeed)]),n("span",{className:"stats-column",id:"download-speed-column",style:{verticalAlign:"top"}}),n("span")]),n("br",{className:"hlsjs"}),n("div",{className:"hlsjs"},[n("span",{className:"stats_name"},[n("text","当前分片：")]),n("span",{style:{width:"180px",height:"5px",display:"inline-block",position:"relative",border:"solid #AAA 1px",borderRadius:"4px",verticalAlign:"middle",marginRight:"2px"}},[n("span",{id:"download-progress-hls",style:{position:"absolute",left:"2px",right:"2px",top:"1px",bottom:"1px",background:"#CCC",borderRadius:"3px",transition:"width .3s",width:0}})]),n("span")]),n("div",{className:"hlsjs"},[n("span",{className:"stats_name"},[n("text",ABP.Strings.statsDownloadSpeed)]),n("span",{className:"stats-column",id:"download-speed-hls-column",style:{verticalAlign:"top"}}),n("span")]),n("br"),n("div",{style:{position:"relative"}},[n("span",{className:"stats_name"},[n("text",ABP.Strings.statsBufferClip)]),n("span",{id:"buffer-clips"},[n("span"),n("span",{},[n("div",{style:{width:"1px",height:"400%",top:"-150%",position:"absolute",background:"#FFF",left:0}})])]),n("pre",{style:{position:"absolute",margin:0,left:"210px",width:"90px",fontFamily:"inherit"}})]),n("div",{id:"canvas-fps"},[n("span",{className:"stats_name"},[n("text","Canvas fps：")]),n("span")]),n("div",{className:"videoQuality"},[n("span",{className:"stats_name"},[n("text",ABP.Strings.statsPresent)]),,n("span",{className:"stats-column",id:"playback-fps-column"}),n("span")]),n("div",{className:"videoQuality"},[n("span",{className:"stats_name"},[n("text",ABP.Strings.statsDrop)]),,n("span",{className:"stats-column",id:"drop-fps-column"}),n("span")]),n("br"),n("div",{style:{fontSize:"11px"}},[n("text",i)]),n("div",{style:{fontSize:"11px"}},[n("text","2017©esterTion")]),n("div",{id:"stats-close"},[n("text","×")])])]),n("div",{className:"ABP-FullScreenProgress"}),n("div",{className:"ABP-Bottom"},[n("div",{className:"ABP-Bottom-Extend"}),n("div",{className:"ABP-Bottom-Wrapper"},[n("div",{className:"ABP-Text"},[n("div",{className:"ABP-CommentStyle"},[n("div",{className:"button-group ABP-Comment-FontGroup"},[n("div",{className:"button ABP-Comment-Font icon-font-style"}),n("div",{className:"ABP-Comment-FontOption"},[n("p",{className:"style-title"},[n("text",ABP.Strings.sendSize)]),n("div",{className:"style-select",name:"commentFontSize"},[n("div",{className:"style-option",value:18},[n("text",ABP.Strings.sendSmall)]),n("div",{className:"style-option on",value:25},[n("text",ABP.Strings.sendMid)])]),n("p",{className:"style-title"},[n("text",ABP.Strings.sendMode)]),n("div",{className:"style-select",name:"commentMode"},[n("div",{className:"style-option",value:5},[n("text",ABP.Strings.sendTop)]),n("div",{className:"style-option on",value:1},[n("text",ABP.Strings.sendScroll)]),n("div",{className:"style-option",value:4},[n("text",ABP.Strings.sendBottom)])])])]),n("div",{className:"button-group ABP-Comment-ColorGroup"},[n("div",{className:"ABP-Comment-Color-Display"}),n("div",{className:"button ABP-Comment-Color icon-color-mode"}),n("div",{className:"ABP-Comment-ColorOption"},[n("div",{className:"ABP-Comment-ColorPicker"})])])]),n("form",{},[n("input",{className:"ABP-Comment-Input"})]),n("div",{className:"ABP-Comment-Send"},[n("text",ABP.Strings.send)])]),n("div",{className:"ABP-Control"},[n("div",{className:"button ABP-Play icon-play"}),n("div",{className:"progress-bar"},[n("div",{className:"bar"},[n("div",{className:"load"}),n("div",{className:"dark"})])]),n("div",{className:"time-label"},[n("text","00:00")]),n("div",{className:"button ABP-Volume icon-volume-high"}),n("div",{className:"volume-bar"},[n("div",{className:"bar"},[n("div",{className:"load"})])]),n("div",{className:"button-group ABP-CommentGroup"},[n("div",{className:"button ABP-CommentShow icon-comment on"}),n("div",{className:"ABP-CommentOption"},[n("p",{className:"label"},[n("text",ABP.Strings.useCSS),n("div",{className:"prop-checkbox"})]),n("p",{className:"label"},[n("text",ABP.Strings.commentSpeed)]),n("div",{className:"speed-bar"},[n("div",{className:"bar"},[n("div",{className:"load"})])]),n("p",{className:"label"},[n("text",ABP.Strings.commentScale)]),n("div",{className:"scale-bar"},[n("div",{className:"bar"},[n("div",{className:"load"})])]),n("p",{className:"label"},[n("text",ABP.Strings.commentOpacity)]),n("div",{className:"opacity-bar",style:{width:"calc(100% - 25px)"}},[n("div",{className:"bar"},[n("div",{className:"load"})])]),n("div",{className:"prop-checkbox",style:{top:"121px"}}),n("div",{className:"shield-enrty"},[n("text",ABP.Strings.commentBlock)])])]),n("div",{className:"button-group ABP-PlaySpeedGroup"},[n("div",{className:"button ABP-Loop icon-loop"})]),n("div",{className:"button ABP-WideScreen icon-tv"}),n("div",{className:"button-group ABP-FullScreenGroup"},[n("div",{className:"button ABP-FullScreen icon-screen-full"}),n("div",{className:"button ABP-Web-FullScreen icon-screen"})])])]),n("div",{className:"BiliPlus-Scale-Menu"},[n("div",{className:"Video-Defination"}),n("div",{className:"Video-Scale"},[n("div",{changeTo:"default",className:"on"},[n("text",ABP.Strings.displayScaleD)]),n("div",{changeTo:"16_9"},[n("text","16:9")]),n("div",{changeTo:"4_3"},[n("text","4:3")]),n("div",{changeTo:"full"},[n("text",ABP.Strings.displayScaleF)])])])])])),l.appendChild(n("div",{className:"shield hidden"},[n("div",{className:"shield_top"},[n("text",ABP.Strings.commentBlock),n("span",{className:"close"})]),n("div",{className:"shield_tabs"},[n("div",{className:"shield_tab on"},[n("div",{},[n("text",ABP.Strings.shieldTypeText)])]),n("div",{className:"shield_tab"},[n("div",{},[n("text",ABP.Strings.shieldTypeUser)])]),n("div",{className:"shield_tab"},[n("div",{},[n("text",ABP.Strings.shieldTypeColor)])]),n("div",{className:"shield_tab"},[n("div",{},[n("text",ABP.Strings.shieldTypeSetting)])])]),n("div",{className:"shield_tab_slash"}),n("div",{className:"shield_body"},[n("div",{className:"shield_body_wrapper"},[n("div",{className:"shield_tab_body"},[n("div",{id:"shield_text"}),n("div",{className:"shield_item"},[n("input",{className:"new",type:"text",placeholder:ABP.Strings.shieldAdd}),n("div",{className:"add"})])]),n("div",{className:"shield_tab_body"},[n("div",{id:"shield_user"})]),n("div",{className:"shield_tab_body"},[n("div",{id:"shield_color"})]),n("div",{className:"shield_tab_body"},[n("div",{className:"shield_toggle",id:"useReg"},[n("text",ABP.Strings.shieldUseRegex)])])])])])),l.appendChild(n("div",{className:"ABP-Comment-List"},[n("div",{className:"ABP-Comment-List-Count"},[n("div",{style:{position:"absolute",right:"200px"}},[n("span",{id:"viewer",style:{fontWeight:"bold"}},[n("text","--")]),n("text",ABP.Strings.viewers)]),n("div",{style:{position:"absolute",right:"20px"}},[n("span",{id:"danmaku",style:{fontWeight:"bold"}},[n("text","--")]),n("text",ABP.Strings.comments)])]),n("div",{className:"ABP-Comment-List-Title"},[n("div",{className:"cmt-time",item:"time"},[n("text",ABP.Strings.commentTime)]),n("div",{className:"cmt-content",item:"content"},[n("text",ABP.Strings.commentContent)]),n("div",{className:"cmt-date",item:"date"},[n("text",ABP.Strings.commentDate)])]),n("div",{className:"ABP-Comment-List-Container"},[n("ul",{className:"ABP-Comment-List-Container-Inner"})])])),l.appendChild(n("div",{className:"Context-Menu"},[n("div",{className:"Context-Menu-Background"}),n("div",{className:"Context-Menu-Body"},[n("div",{id:"Player-Stats-Toggle"},[n("text",ABP.Strings.showStats)]),n("div",{id:"Player-Speed-Control",className:"dm"},[n("div",{className:"content"},[n("text",ABP.Strings.playSpeed)]),n("div",{className:"dmMenu",style:{top:"-37px"}},[n("div",{"data-speed":.5},[n("text",.5)]),n("div",{"data-speed":1},[n("text",1)]),n("div",{"data-speed":1.25},[n("text",1.25)]),n("div",{"data-speed":1.5},[n("text",1.5)]),n("div",{"data-speed":2},[n("text",2)])])]),n("div",{className:"about"},[n("text",i)])])]));var g=ABP.bind(l);if(r.length>0){var y=r[0];g.gotoNext=function(){var t=r.indexOf(y)+1;if(t<r.length){y=r[t],y.style.display="";var i=g.video.parentNode;i.removeChild(g.video),i.appendChild(y),g.video.style.display="none",g.video=y,g.swapVideo(y),y[e]("ended",function(){g.gotoNext()})}},y[e]("ended",function(){g.gotoNext()})}return g};var g=function(){var t=3988292384,e=new Array(256),i=function(){var i,o,n;for(o=0;o<256;++o){for(i=o,n=0;n<8;++n)i=0!=(1&i)?t^i>>>1:i>>>1;e[o]=i}},o=function(t,i){for(var o,n=4294967295,a=t.length,s=0;s<a;++s)o=255&(n^t.charCodeAt(s)),n=n>>>8^e[o];return i?o:n},n=function(t){for(var i=0;i<256;i++)if(e[i]>>>24==t)return i;return-1},a="",s=function(t,i){var n=0,s="",l=o(t.toString(),!1);return n=255&l^i[2],n<=57&&n>=48?(s+=n-48,l=e[i[2]]^l>>>8,n=255&l^i[1],n<=57&&n>=48?(s+=n-48,l=e[i[1]]^l>>>8,n=255&l^i[0],n<=57&&n>=48?(s+=n-48,l=e[i[0]]^l>>>8,a=s,1):0):0):0};i();var l=new Array(4);return function(t){var i,r,c,d=4294967295^parseInt(t,16);for(r=1;r<1001;r++)if(d==o(r.toString(),!1))return r;for(r=3;r>=0;r--)l[3-r]=n(d>>>8*r),i=e[l[3-r]],d^=i>>>8*(3-r);for(r=0;r<1e5&&(c=o(r.toString(),!0),c!=l[3]||!s(r,l));r++);return 1e5==r?-1:r+""+a}},y=function(t){for(var e,i,o=0,n=t.currentTime;o<t.buffered.length;o++)if(n>=t.buffered.start(o)&&n<=t.buffered.end(o)){e=t.buffered.start(o),i=t.buffered.end(o);break}return o==t.buffered.length?{start:0,end:0,delta:0}:{start:e,end:i,delta:i-n}};window.crc_engine=new g,ABP.bind=function(i,o){var a={playerUnit:i,btnPlay:null,barTime:null,barFullScreenTime:null,barLoad:null,barTimeHitArea:null,barVolume:null,barVolumeHitArea:null,barOpacity:null,barOpacityHitArea:null,barScale:null,barScaleHitArea:null,barSpeed:null,barSpeedHitArea:null,btnFont:null,btnColor:null,btnSend:null,controlBar:null,timeLabel:null,timeJump:null,divComment:null,btnWide:null,btnFull:null,btnWebFull:null,btnDm:null,btnLoop:null,btnProp:null,btnAutoOpacity:null,videoDiv:null,btnVolume:null,video:null,txtText:null,commentColor:"ffffff",commentFontSize:25,commentMode:1,displayColor:null,cmManager:null,commentList:null,commentListContainer:null,lastSelectedComment:null,commentCoolDown:1e4,commentScale:ABP.playerConfig.scale?ABP.playerConfig.scale:1,commentSpeed:ABP.playerConfig.speed?ABP.playerConfig.speed:1,proportionalScale:ABP.playerConfig.prop,defaults:{w:0,h:0},state:v(o,{fullscreen:!1,commentVisible:!0,allowRescale:!1,autosize:!1,widescreen:!1}),createPopup:function(t,e){if(i.hasPopup===!0)return!1;var o=n("div",{className:"ABP-Popup"},[n("text",t)]);return o.remove=function(){o.isRemoved||(o.isRemoved=!0,i.removeChild(o),i.hasPopup=!1)},i.appendChild(o),i.hasPopup=!0,"number"==typeof e&&(e=5e3),setTimeout(function(){o.remove()},e),o},removePopup:function(){for(var t=i.getElementsByClassName("ABP-Popup"),e=0;e<t.length;e++)null!=t[e].remove?t[e].remove():t[e].parentNode.removeChild(t[e]);i.hasPopup=!1},loadCommentList:function(t,i){i="asc"==i?-1:1;var o=Object.keys(a.commentList).sort(function(e,o){return a.commentList[e][t]<a.commentList[o][t]?i:a.commentList[e][t]>a.commentList[o][t]?-i:0});a.commentObjArray=[];for(b in o){var s=o[b],l=a.commentList[s];if(l&&l.time){var r=n("li",{}),h=n("span",{className:"cmt-time"},[n("text",d(l.time/1e3))]),m=n("span",{className:"cmt-content"},[n("text",l.content)]),p=n("span",{className:"cmt-date"},[n("text",c(l.date,!0))]);u(m,!1,36),u(p,!1,18),m.tooltip(l.content),p.tooltip(c(l.date)),r.appendChild(h),r.appendChild(m),r.appendChild(p),r.data=l,r.originalData=danmaku,8==l.mode?r.style.background="#ffe100":0!=l.pool&&(r.style.background="#20ff20"),r[e]("dblclick",function(t){a.video.currentTime=this.data.time/1e3,Zt(g.currentTime)}),a.commentObjArray.push(r)}}a.commentListContainer.style.height=24*a.commentObjArray.length+"px",a.renderCommentList(),a.playerUnit.querySelector(".ABP-Comment-List-Count span#danmaku").innerHTML=a.commentObjArray.length},renderCommentList:function(){var t=a.commentListContainer.parentElement.scrollTop,i=parseInt(t/24);a.commentListContainer.innerHTML="";for(var o=i;o<=i+40&&"undefined"!=typeof a.commentObjArray[o];o++){if(o==i&&o>0){var n=a.commentObjArray[o].cloneNode(!0),s=n.getElementsByClassName("cmt-content")[0],l=n.getElementsByClassName("cmt-date")[0];n[e]("dblclick",function(t){a.video.currentTime=a.commentObjArray[o].data.time/1e3,Zt(g.currentTime)}),u(s,!1,36),u(l,!1,18),s.tooltip(a.commentObjArray[o].data.content),l.tooltip(c(a.commentObjArray[o].data.date)),n.style.paddingTop=24*i+"px"}else var n=a.commentObjArray[o];a.commentObjArray[o].data.originalData.isBlocked?a.commentObjArray[o].childNodes[0].className="cmt-time blocked":a.commentObjArray[o].childNodes[0].className="cmt-time",a.commentListContainer.appendChild(n)}a.commentListContainer.parentElement.scrollTop=t},commentCallback:function(t){t.result?(a.commentList[t.id]=a.commentList[t.tmp_id],delete a.commentList[t.tmp_id]):(delete a.commentList[t.tmp_id],a.createPopup(t.error,5e3))},swapVideo:null},s=function(t,e){var i=localStorage.html5Settings||"{}";i=JSON.parse(i),i[t]=e,localStorage.html5Settings=JSON.stringify(i)};if(s.scale=function(t){s("scale",a.commentScale)},s.opacity=function(t){s("opacity",a.cmManager.options.global.opacity)},s.speed=function(t){s("speed",a.commentSpeed)},s.commentVisible=function(t){s("commentVisible",a.cmManager.display)},s.useCSS=function(t){s("useCSS",a.cmManager.options.global.useCSS)},s.autoOpacity=function(t){s("autoOpacity",a.cmManager.options.global.autoOpacity)},a.swapVideo=function(t){var o=function(){if(!Gt){Zt(t.currentTime);try{a.barLoad.style.width="100%"}catch(t){return}}};t[e]("timeupdate",o),t[e]("ended",function(){a.btnPlay.className="button ABP-Play icon-play",a.barTime.style.width="0%",a.barFullScreenTime.style.width="0%"}),t[e]("progress",o),t.isBound=!0;var n=0,s=!1;if(a.cmManager){a.cmManager[e]("load",function(){a.commentList={};for(b in a.cmManager.timeline){var t=a.cmManager.timeline[b];8!=t.mode||s||(s=!0,setTimeout(function(){var t=new CCLScripting("/js/CommentCoreLibraryScripting.min.js");a.cmManager.scripting=t.getSandbox(a.divComment,a.video)},0)),t.dbid&&t.stime&&(a.commentList[t.dbid]={date:t.date,time:t.stime,mode:t.mode,user:t.hash,pool:t.pool,content:t.text||t.code,originalData:t})}a.loadCommentList("date","asc"),a.commentListContainer.parentElement[e]("scroll",a.renderCommentList)}),a.cmManager.setBounds=function(){i.offsetHeight<=300||i.offsetWidth<=700?m(i,"ABP-Mini"):f(i,"ABP-Mini");var t=a.videoDiv.offsetWidth,e=a.videoDiv.offsetHeight;a.proportionalScale?e/493*a.commentScale:a.commentScale;this.width=t,this.height=e,this.options.global.scale=this.width/680/a.commentSpeed,this.dispatchEvent("resize");for(var o in this.csa)this.csa[o].setBounds(this.width,this.height);this.stage.style.width=this.width+"px",this.stage.style.height=this.height+"px",this.stage.style.perspective=this.width*Math.tan(40*Math.PI/180)/2+"px",this.stage.style.webkitPerspective=this.width*Math.tan(40*Math.PI/180)/2+"px",i.querySelector(".BiliPlus-Scale-Menu .Video-Scale div.on").click(),this.canvasResize()},a.cmManager.setBounds(),a.cmManager.clear();var l=0,r=!1,c=!1,d=function(){c=!1,t.removeEventListener("canplay",d),t.paused&&a.btnPlay.click()},h=function(){var e=t.readyState,i=document.getElementById("info-box");if(!t.ended)switch(e){case 1:isMobile()&&t.paused&&a.createPopup("请点击播放器开始播放",3e3);case 2:0==i.style.opacity&&(i.style.opacity=1),dots.running||dots.runTimer();try{var o=y(t);i.childNodes[0].childNodes[0].innerHTML=ABP.Strings.buffering+" "+Math.floor(100*o.delta)/100+"s"}catch(t){i.childNodes[0].childNodes[0].innerHTML=ABP.Strings.buffering}break;case 3:case 4:1==i.style.opacity&&(i.style.opacity=0,dots.stopTimer())}};t[e]("autoplay",function(){t[e]("canplay",d)}),t[e]("loop",function(){r=t.loop}),t[e]("canplay",d),t[e]("canplay",h),t[e]("waiting",h),t[e]("progress",h),t[e]("progress",function(){n==t.currentTime&&u&&(new Date).getTime()-l>=100?t.hasStalled=!0:n!=t.currentTime&&(n=t.currentTime),l=(new Date).getTime()}),window&&window[e]("resize",function(){a.cmManager.setBounds()}),t[e]("timeupdate",function(){a.cmManager.display!==!1&&(t.hasStalled&&(t.hasStalled=!1),a.cmManager.time(Math.floor(1e3*t.currentTime)))}),t[e]("ratechange",function(){1!=this.playbackRate&&(a.createPopup("检测到播放速度改变，10秒后恢复",3e3),setTimeout(function(){t.playbackRate=1,a.createPopup("播放速度已恢复",1e3)},1e4))});var u=!1;t[e]("pause",function(){u=!1}),t[e]("waiting",function(){u=!1}),t[e]("playing",function(){u=!0})}},null!==i&&null!==i.getElementsByClassName){a.defaults.w=i.offsetWidth,a.defaults.h=i.offsetHeight;var r=i.getElementsByClassName("ABP-Video");if(!(r.length<=0)){var g=null;a.videoDiv=r[0];for(var b in r[0].children)if(null!=r[0].children[b].tagName&&"VIDEO"===r[0].children[b].tagName.toUpperCase()){g=r[0].children[b];break}var x=r[0].getElementsByClassName("ABP-Container");if(x.length>0&&(a.divComment=x[0]),null!==g){a.video=g,a.video.seek=function(t){this.currentTime=parseFloat(t)/1e3};var S=i.getElementsByClassName("ABP-Play");if(!(S.length<=0)){a.btnPlay=S[0],a.btnPlay.tooltip(ABP.Strings.play),u(a.btnPlay);var w=i.getElementsByClassName("progress-bar");if(!(w.length<=0)){var C=w[0].getElementsByClassName("bar");a.barTimeHitArea=C[0],a.barLoad=C[0].getElementsByClassName("load")[0],a.barTime=C[0].getElementsByClassName("dark")[0];var k=i.getElementsByClassName("ABP-FullScreenProgress");if(!(k.length<=0)){a.barFullScreenTime=k[0];var _=i.getElementsByClassName("time-label");if(!(_.length<=0)){a.timeLabel=_[0];var A=i.getElementsByClassName("ABP-Volume");if(!(A.length<=0)){a.btnVolume=A[0],a.btnVolume.tooltip(ABP.Strings.mute),u(a.btnVolume);var P=i.getElementsByClassName("volume-bar");if(!(P.length<=0)){var B=P[0].getElementsByClassName("bar");a.barVolumeHitArea=B[0],a.barVolume=B[0].getElementsByClassName("load")[0];var N=i.getElementsByClassName("opacity-bar");if(!(N.length<=0)){var N=N[0].getElementsByClassName("bar");a.barOpacityHitArea=N[0],a.barOpacity=N[0].getElementsByClassName("load")[0];var T=i.getElementsByClassName("scale-bar");if(!(T.length<=0)){var T=T[0].getElementsByClassName("bar");a.barScaleHitArea=T[0],a.barScale=T[0].getElementsByClassName("load")[0];var M=i.getElementsByClassName("speed-bar");if(!(M.length<=0)){var M=M[0].getElementsByClassName("bar");a.barSpeedHitArea=M[0],a.barSpeed=M[0].getElementsByClassName("load")[0];var L=i.getElementsByClassName("prop-checkbox");if(!(L.length<=0)){a.btnAutoOpacity=L[1],a.btnAutoOpacity.tooltip(ABP.Strings.autoOpacityOn),u(a.btnAutoOpacity),a.btnProp=L[0],a.btnProp.tooltip(ABP.Strings.usingCanvas),u(a.btnProp);var F=i.getElementsByClassName("ABP-FullScreen");if(!(F.length<=0)){a.btnFull=F[0],a.btnFull.tooltip(ABP.Strings.fullScreen),u(a.btnFull);var E=i.getElementsByClassName("ABP-Web-FullScreen");if(!(E.length<=0)){a.btnWebFull=E[0],a.btnWebFull.tooltip(ABP.Strings.webFull),u(a.btnWebFull);var O=i.getElementsByClassName("ABP-WideScreen");if(!(O.length<=0)){a.btnWide=O[0],a.btnWide.tooltip(ABP.Strings.wideScreen),u(a.btnWide);var H=i.getElementsByClassName("ABP-Comment-Font");if(!(H.length<=0)){a.btnFont=H[0],a.btnFont.tooltip(ABP.Strings.sendStyle),u(a.btnFont);var D=i.getElementsByClassName("ABP-Comment-Color");if(!(D.length<=0)){a.btnColor=D[0],a.btnColor.tooltip(ABP.Strings.sendColor),u(a.btnColor);var I=i.getElementsByClassName("ABP-Comment-Color-Display");if(!(I.length<=0)){a.displayColor=I[0];var R=i.getElementsByClassName("ABP-Comment-Input");if(!(R.length<=0)){a.txtText=R[0];var V=i.getElementsByClassName("ABP-Comment-List-Container-Inner");if(!(V.length<=0)){a.commentListContainer=V[0];var W=i.getElementsByClassName("ABP-Comment-Send");if(!(W.length<=0)){a.btnSend=W[0],a.btnSend.tooltip(ABP.Strings.sendTooltip),u(a.btnSend);var j=i.getElementsByClassName("ABP-Control");j.length>0&&(a.controlBar=j[0]);var z=i.getElementsByClassName("ABP-CommentShow");if(!(z.length<=0)){a.btnDm=z[0],a.btnDm.tooltip(ABP.Strings.hideComment),u(a.btnDm);var q=i.getElementsByClassName("ABP-Loop");if(!(q.length<=0)){a.btnLoop=q[0],a.btnLoop.tooltip(ABP.Strings.loopOff),u(a.btnLoop);var U={videoDimension:!0,gecko:!0,webkit:!0,videoQuality:!0,flvjs:!0},X=function(t){return document.querySelector(t)},Y=function(t){return(1*t).toFixed(2)},J=">:last-child",Q=X("#player-dimension"+J),G=X("#video-dimension"+J),Z=X("#canvas-fps"+J),K=X("#buffer-health-column"),$=X("#realtime-bitrate-column"),tt=X("#download-speed-column"),et=X("#download-speed-hls-column"),it=X("#playback-fps-column"),ot=it.parentNode.lastChild,nt=X("#drop-fps-column"),at=nt.parentNode.lastChild,st=[],lt=[],rt=[],ct=[],dt=[],ht=[],ut=0,mt=0,pt=X("#buffer-health"+J),ft='<svg style="width:180px;height:21px"><polyline style="fill:transparent;stroke:#ccc"></polyline><polyline points="1,21 180,21 180,1" style="fill:transparent;stroke:#fff"></polyline></svg>',vt="",gt=document.createElement("style"),yt=document.createElement("style"),bt=document.createElement("style"),xt=document.querySelectorAll(".flvjs>:last-child"),St=document.querySelectorAll(".hlsjs>:last-child"),b=0,wt=function(t,e){var i,o=0,n=[];e.forEach(function(t){o=t>o?t:o}),0==o&&(o=1);for(i in e)n.push(3*i+","+(20*(1-e[i]/o)+1)+" "+(3*i+3)+","+(20*(1-e[i]/o)+1));t.setAttribute("points",n.join(" "))},Ct=!1,kt=X("#Player-Stats-Toggle"),_t=function(t){"stats-close"==t.target.id&&t.stopPropagation(),X(".Player-Stats").style.display=Ct?"":"block",Ct=!Ct},At=-1,Pt=!1;for(kt[e]("click",_t),X("#stats-close")[e]("click",_t);b<60;b++)st.push(0),lt.push(0),rt.push(0),ct.push(0),dt.push(0),ht.push(0);if(K.innerHTML=ft,K=K.querySelector("polyline"),$.innerHTML=ft,$=$.querySelector("polyline"),tt.innerHTML=ft,tt=tt.querySelector("polyline"),et.innerHTML=ft,et=et.querySelector("polyline"),it.innerHTML=ft,it=it.firstChild.firstChild,nt.innerHTML=ft,nt=nt.firstChild.firstChild,void 0==g.videoWidth&&(U.videoDimension=!1,vt+="#video-dimension{display:none}"),void 0==g.getVideoPlaybackQuality&&(U.videoQuality=!1,vt+=".videoQuality{display:none}"),gt.innerHTML=vt,document.head.appendChild(gt),yt.innerHTML=".flvjs{display:none}",document.head.appendChild(yt),bt.innerHTML=".hlsjs{display:none}",document.head.appendChild(bt),setInterval(function(){Pt=!Pt,Q.innerHTML=g.offsetWidth+"x"+g.offsetHeight+" *"+devicePixelRatio,U.videoDimension&&(G.innerHTML=g.videoWidth+"x"+g.videoHeight);var t={};try{t=y(g)}catch(t){}if(t=t.delta||0,st.push(t),st.shift(),pt.innerHTML=Y(t)+"s",wt(K,st),Ct){for(var e,i,o=g.buffered,s=X("#buffer-clips>span"),l=g.duration==1/0?o.end(o.length-1):g.duration,r=[],c=0;c<o.length;c++)c>=s.childNodes.length&&s.appendChild(n("span",{className:"buffer-clip"})),e=o.start(c),i=o.end(c)-e,s.childNodes[c].style.left=Y(e/l*100)+"%",s.childNodes[c].style.width=Y(i/l*100)+"%",r.push(d(0|e)+" - "+d(e+i|0));for(;c<s.childNodes.length;)s.childNodes[c].remove();s.parentNode.parentNode.childNodes[2].innerHTML=r.join("\n"),X("#buffer-clips>span>div").style.left=Y(g.currentTime/l*100)+"%"}if(null!=player.flv){yt.textContent="";var h,u,c=0,m=player.flv._mediaInfo,p=player.flv.statisticsInfo,f=g.currentTime,v=player.flv._mediaDataSource.segments,b=0,x=0;for(u=0;u<v.length;u++){if(f<=(b+v[u].duration)/1e3){b=f-b/1e3|0;break}b+=v[u].duration,x++}if(xt[c++].textContent=m.videoCodec||"",xt[c++].textContent=m.audioCodec||"",xt[c++].textContent=Y(m.fps),xt[c++].textContent=Y(m.videoDataRate)+" kbps",xt[c++].textContent=Y(m.audioDataRate)+" kbps",m.bitrateMap){var h,f=g.currentTime,b=0|f,x=0;m.bitrateMap[x]&&(h=m.bitrateMap[x][b]),void 0!=h?Pt&&At!=(0|g.currentTime)?(At=0|g.currentTime,xt[c++].textContent=Y(h)+" kbps",lt.push(h),lt.shift(),Ct&&wt($,lt)):c++:xt[c++].textContent="N/A"}else xt[c++].textContent="N/A";Pt?("number"==typeof p.speed&&(rt.push(p.speed),rt.shift()),Ct&&wt(tt,rt),xt[c++].textContent=Y(p.speed)+" KB/s",player.flv._statisticsInfo.speed=0):c++}else{yt.textContent=".flvjs{display:none}";for(var S=X("#buffer-clips>span:nth-of-type(2)").children;S.length>1;)S[1].remove()}if(null!=player.hls){bt.innerHTML="";var w,C=0,c=0;if(void 0!=player.hls.fragmentLoader.loaders.main&&(w=player.hls.fragmentLoader.loaders.main,w.stats.total&&(C=w.stats.loaded/w.stats.total*100)),X("#download-progress-hls").style.width=C+"%",St[c++].innerHTML=Y(C)+"%",Pt){var k=player.hls.speed||0;ct.push(k),ct.shift(),Ct&&wt(et,ct),St[c++].innerHTML=Y(k)+" KB/s"}}else bt.innerHTML=".hlsjs{display:none}";if(Pt&&(Z.innerHTML=a.cmManager.canvasFPS),Pt&&U.videoQuality){var _=g.getVideoPlaybackQuality();ut>_.totalVideoFrames&&(ut=0),mt>_.droppedVideoFrames&&(mt=0);var A=_.totalVideoFrames-ut,P=_.droppedVideoFrames-mt;ut=_.totalVideoFrames,mt=_.droppedVideoFrames,dt.push(A),dt.shift(),ht.push(P),ht.shift(),Ct&&(wt(it,dt),wt(nt,ht)),ot.textContent=A+" fps",at.textContent=P+" fps "+(P/A*100).toFixed(2)+"%"}},500),"undefined"!=typeof CommentManager&&(a.cmManager=new CommentManager(a.divComment),a.cmManager.display=!0,a.cmManager.init(),a.cmManager.clear(),a.cmManager.filter.addModifier(shield.filter),a.cmManager.startTimer(),window&&window[e]("resize",function(){a.cmManager.setBounds()})),"object"==typeof ABP.playerConfig&&(ABP.playerConfig.volume&&(a.video.volume=ABP.playerConfig.volume),ABP.playerConfig.opacity&&(a.cmManager.options.global.opacity=ABP.playerConfig.opacity)),t(".ABP-Comment-List-Title *").click(function(){var e=t(this).attr("item"),i=t(this).hasClass("asc")?"desc":"asc";t(".ABP-Comment-List-Title *").removeClass("asc").removeClass("desc"),t(this).addClass(i),a.loadCommentList(e,i)}),t(".ABP-Unit .ABP-CommentStyle .ABP-Comment-FontOption .style-option").click(function(){t(this).closest(".style-select").find(".style-option").removeClass("on"),t(this).addClass("on"),a[t(this).closest(".style-select").attr("name")]=parseInt(t(this).attr("value"))}),t(i).find(".ABP-Comment-ColorPicker").colpick({flat:!0,submit:0,color:"ffffff",onChange:function(t,e){a.commentColor=e,a.displayColor.style.backgroundColor="#"+e}}),g.isBound!==!0){a.swapVideo(g),a.playerUnit.querySelector(".BiliPlus-Scale-Menu .Video-Defination")[e]("click",function(t){if(!t.target.hasAttribute("changeto"))return!1;var e=JSON.parse(t.target.getAttribute("changeto"));changeSrc({target:{value:e[1]}},e[0]),f(t.target.parentNode.querySelector(".on"),"on"),m(t.target,"on")}),a.playerUnit.querySelector(".BiliPlus-Scale-Menu .Video-Scale")[e]("click",function(t){if(!t.target.hasAttribute("changeto"))return!1;switch(t.target.getAttribute("changeto")){case"default":p(a.video,"scale")&&f(a.video,"scale"),a.video.style.width="",a.video.style.height="",a.video.style.paddingTop="",
a.video.style.paddingLeft="";break;case"16_9":m(a.video,"scale");var e=a.videoDiv.offsetWidth,i=a.videoDiv.offsetHeight,o="",n="";e<i/9*16?(o=(i-e/16*9)/2+"px",i=e/16*9/i*100+"%",e="100%"):(n=(e-i/9*16)/2+"px",e=i/9*16/e*100+"%",i="100%"),a.video.style.width=e,a.video.style.height=i,a.video.style.paddingTop=o,a.video.style.paddingLeft=n;break;case"4_3":m(a.video,"scale");var e=a.videoDiv.offsetWidth,i=a.videoDiv.offsetHeight,o="",n="";e<i/3*4?(o=(i-e/4*3)/2+"px",i=e/4*3/i*100+"%",e="100%"):(n=(e-i/3*4)/2+"px",e=i/3*4/e*100+"%",i="100%"),a.video.style.width=e,a.video.style.height=i,a.video.style.paddingTop=o,a.video.style.paddingLeft=n;break;case"full":m(a.video,"scale"),a.video.style.width="",a.video.style.height="",a.video.style.paddingTop="",a.video.style.paddingLeft=""}f(t.target.parentNode.querySelector(".on"),"on"),m(t.target,"on")});var Bt=0,Nt=function(t){var e=Date.now();e-Bt<=500?a.btnFull.click():g.paused&&a.btnPlay.click(),Bt=e,t.preventDefault()};a.videoDiv[e]("click",Nt),a.playerUnit.querySelector(".ABP-Bottom-Extend")[e]("click",function(t){t.preventDefault(),t.stopPropagation(),Nt(t)});var Tt=null;a.videoDiv[e]("mousemove",function(){Tt&&window.clearTimeout(Tt),p(a.videoDiv,"ABP-HideCursor")&&f(a.videoDiv,"ABP-HideCursor"),Tt=window.setTimeout(function(){m(a.videoDiv,"ABP-HideCursor")},3e3)}),a.btnVolume[e]("click",function(){0==a.video.muted?(a.video.muted=!0,this.className="button ABP-Volume icon-volume-mute2",this.tooltip(ABP.Strings.unmute),a.barVolume.style.width="0%"):(a.video.muted=!1,this.className="button ABP-Volume icon-volume-",a.video.volume<.1?this.className+="mute":a.video.volume<.33?this.className+="low":a.video.volume<.67?this.className+="medium":this.className+="high",this.tooltip(ABP.Strings.mute),a.barVolume.style.width=100*a.video.volume+"%")}),a.btnWebFull[e]("click",function(){a.state.fullscreen=p(i,"ABP-FullScreen"),m(i,"ABP-FullScreen"),unsafeWindow&&unsafeWindow.player_fullwin&&unsafeWindow.player_fullwin(!0),a.btnFull.className="button ABP-FullScreen icon-screen-normal",a.btnFull.tooltip(ABP.Strings.exitWebFull),a.state.fullscreen=!0,a.cmManager&&a.cmManager.setBounds(),a.state.allowRescale&&(a.state.fullscreen?a.defaults.w>0&&(a.cmManager.options.scrollScale=i.offsetWidth/a.defaults.w):a.cmManager.options.scrollScale=1)});var Mt=!1,Lt=!1;a.btnFont[e]("click",function(t){Lt&&a.btnColor.click(),this.parentNode.classList.toggle("on"),Mt=!Mt}),a.btnColor[e]("click",function(t){Mt&&a.btnFont.click(),this.parentNode.classList.toggle("on"),Lt=!Lt}),a.btnAutoOpacity[e]("click",function(t){this.classList.toggle("on");var e=this.classList.contains("on");a.cmManager.autoOpacity(e),this.tooltip(e?ABP.Strings.autoOpacityOn:ABP.Strings.autoOpacityOff),s.autoOpacity()}),ABP.playerConfig.autoOpacity&&a.btnAutoOpacity.click(),a.btnProp[e]("click",function(t){this.classList.toggle("on");var e=this.classList.contains("on");a.cmManager.useCSS(e),this.tooltip(e?ABP.Strings.usingCSS:ABP.Strings.usingCanvas),s.useCSS()}),ABP.playerConfig.useCSS&&a.btnProp.click();var Ft=function(){!document.isFullScreen()&&p(i,"ABP-FullScreen")&&(f(i,"ABP-FullScreen"),a.btnFull.className="button ABP-FullScreen icon-screen-full",a.btnFull.tooltip(ABP.Strings.fullScreen),a.state.fullscreen=!!document.isFullScreen())};document[e]("fullscreenchange",Ft,!1),document[e]("webkitfullscreenchange",Ft,!1),document[e]("mozfullscreenchange",Ft,!1),document[e]("MSFullscreenChange",Ft,!1),a.btnFull[e]("click",function(){a.state.fullscreen=p(i,"ABP-FullScreen"),a.state.fullscreen?(f(i,"ABP-FullScreen"),unsafeWindow&&unsafeWindow.player_fullwin&&unsafeWindow.player_fullwin(!1),this.className="button ABP-FullScreen icon-screen-full",this.tooltip(ABP.Strings.fullScreen),document.exitFullscreen()):(m(i,"ABP-FullScreen"),this.className="button ABP-FullScreen icon-screen-normal",this.tooltip(ABP.Strings.exitFullScreen),i.requestFullScreen()),a.state.fullscreen=!a.state.fullscreen,a.cmManager&&a.cmManager.setBounds(),a.state.allowRescale&&(a.state.fullscreen?a.defaults.w>0&&(a.cmManager.options.scrollScale=i.offsetWidth/a.defaults.w):a.cmManager.options.scrollScale=1)}),a.btnWide[e]("click",function(){a.state.widescreen=p(i,"ABP-WideScreen"),a.state.widescreen?(f(i,"ABP-WideScreen"),this.className="button ABP-WideScreen icon-tv",i.dispatchEvent(new Event("normal")),this.tooltip(ABP.Strings.wideScreen)):(m(i,"ABP-WideScreen"),this.className="button ABP-WideScreen icon-tv on",i.dispatchEvent(new Event("wide")),this.tooltip(ABP.Strings.exitWideScreen)),a.state.widescreen=!a.state.widescreen,a.cmManager&&a.cmManager.setBounds(),a.state.allowRescale&&(a.state.fullscreen?a.defaults.w>0&&(a.cmManager.options.scrollScale=i.offsetWidth/a.defaults.w):a.cmManager.options.scrollScale=1)}),a.btnDm[e]("click",function(){0==a.cmManager.display?(a.cmManager.display=!0,a.cmManager.startTimer(),this.className="button ABP-CommentShow icon-comment on",this.tooltip(ABP.Strings.hideComment)):(a.cmManager.display=!1,a.cmManager.clear(),a.cmManager.stopTimer(),this.className="button ABP-CommentShow icon-comment",this.tooltip(ABP.Strings.showComment)),s.commentVisible()}),a.btnLoop[e]("click",function(){null!=player.flv&&(player.flv.unload(),player.flv.load(),a.video.currentTime=0,a.video.play())});var Et=a.playerUnit.querySelector(".Context-Menu"),Ot=Et.querySelector(".Context-Menu-Background"),Ht=Et.querySelector(".Context-Menu-Body"),Dt=function(t){return Yt?(t.preventDefault(),t.stopPropagation(),Yt=!1,!1):(Et.style.display="none",void t.preventDefault())},It=function(t){for(var e=0,i=-1,e=0,o=a.commentObjArray.length;e<o;e++)if(a.commentObjArray[e].data.originalData.dbid==t){i=e;break}i!=-1&&(a.state.fullscreen&&a.btnFull.click(),a.state.widescreen&&a.btnWide.click(),a.commentListContainer.parentNode.scrollTop=24*i)},Rt=null,Vt=null,Wt=0,jt=null,zt={},qt=function(){if(0!=Wt){if(void 0!=zt[Wt])return void Ht.dispatchEvent(new CustomEvent("senderInfoFetched",{detail:zt[Wt]}));var t=n("script",{className:"info_jsonp",src:"//account.bilibili.com/api/member/getCardByMid?type=jsonp&callback=getSenderInfo&mid="+Wt});document.body.appendChild(t)}},Ut=function(t,i,o){Et.style.display="block";var s,l,r,c,d,h=Ht.querySelectorAll(".dm"),u=a.playerUnit.getBoundingClientRect();for(b=h.length-2;b>=0;b--)h[b].remove();for(s=Ht.firstChild,b=0;b<o.length;b++){if(l=o[b].originalData,r=l.color.toString(16).padStart(6,"0"),c=16777215==l.color,d=n("div",{className:"dm"},[n("div",{className:"content"},[n("text",l.text)]),n("div",{className:"dmMenu"},[n("div",{"data-content":l.text},[n("text",ABP.Strings.copyComment)]),n("div",{"data-dmid":l.dbid},[n("text",ABP.Strings.findComment)]),n("div",{onclick:'shield.addText("'+l.text+'")'},[n("text",ABP.Strings.blockContent+"“"+l.text+"”")]),n("div",{"data-mid":crc_engine(l.hash),onclick:'shield.addUser("'+l.hash+'")'},[n("text",ABP.Strings.blockUser+""+l.hash+"(mid:"+crc_engine(l.hash)+")")]),n("div",c?{}:{onclick:'shield.addColor("'+r+'")'},[n("text",c?ABP.Strings.blockColorWhite:ABP.Strings.blockColor+""),n("div",{className:"color",style:{background:"#"+r}})])])]),l.mode>6){d.childNodes[0].innerHTML="特殊弹幕";var m=d.childNodes[1];m.childNodes[0].style.display="none",m.childNodes[2].style.display="none",m.childNodes[4].style.display="none"}Ht.insertBefore(d,s)}var p=Ht.querySelectorAll(".dmMenu");for(b=0;b<p.length-1;b++)p[b].childNodes[0][e]("click",function(){try{var t=document.createElement("input");t.style.width=0,t.style.height=0,document.body.appendChild(t),t.value=this.getAttribute("data-content"),t.select();var e=document.execCommand("copy");if(document.body.removeChild(t),!e)throw""}catch(t){a.createPopup(ABP.Strings.copyFail,3e3)}}),p[b].childNodes[1][e]("click",function(){It(this.getAttribute("data-dmid"))}),p[b].childNodes[3][e]("mouseenter",function(){Wt=this.getAttribute("data-mid"),jt=this,Rt=setTimeout(qt,500)}),p[b].childNodes[3][e]("mouseleave",function(){clearTimeout(Rt),Wt=0,jt=null,null!=document.getElementById("Sender-Info")&&(clearTimeout(Vt),Vt=setTimeout(function(){document.body.removeChild(document.getElementById("Sender-Info"))},500))});t-=u.left,i-=u.top,u.width-t<300&&(t=u.width-300),u.height-Ht.offsetHeight-i<0&&(i=u.height-Ht.offsetHeight);var f=Ht.querySelector(".dm:nth-last-of-type(2)>.dmMenu");if(null!=f){f.style.display="block";var v=f.getBoundingClientRect();f.style.display="",u.top+u.height-v.height-i<0&&(i=u.height-v.height)}Ht.style.left=t+"px",Ht.style.top=i+"px"},Xt=null,Yt=!1;Ht.querySelector("#Player-Speed-Control .dmMenu")[e]("click",function(t){var e=t.target.getAttribute("data-speed");void 0!=e&&(a.video.playbackRate=e)}),Ht[e]("senderInfoFetched",function(t){var i=t.detail;if(i.mid==Wt&&null!=jt){var o=jt.parentNode.getBoundingClientRect(),a=o.left-150,s=innerHeight-o.bottom,l=n("div",{className:"Context-Menu-Body",id:"Sender-Info",style:{left:a+"px",bottom:s+"px",position:"fixed",fontFamily:"-apple-system,Arial,'PingFang SC','STHeiti Light','Hiragino Kaku Gothic ProN','Microsoft YaHei'",textAlign:"center"}},[n("div",{},[n("img",{style:{height:"130px",width:"130px"},src:i.face.replace(/http\:/,"")})]),n("div",{},[n("text",i.name)]),n("div",{},[n("text",i.mid)]),n("div",{},[n("text","LV"+i.level_info.current_level)])]);document.body.appendChild(l),s+l.offsetHeight>innerHeight&&(l.style.bottom="",l.style.top=o.top+"px"),l[e]("click",function(){window.open("/space/"+i.mid+"/"),document.body.removeChild(l)}),l[e]("mouseenter",function(){clearTimeout(Vt)}),l[e]("mouseleave",function(){clearTimeout(Vt),Vt=setTimeout(function(){document.body.removeChild(document.getElementById("Sender-Info"))},500)})}}),window.getSenderInfo=function(t){0==t.code&&(zt[Wt]=t.card,Ht.dispatchEvent(new CustomEvent("senderInfoFetched",{detail:t.card})))},Et[e]("click",Dt),Ot[e]("contextmenu",Dt),a.videoDiv.parentNode[e]("contextmenu",function(t){t.preventDefault(),t.stopPropagation();var e=a.divComment.getBoundingClientRect(),i=t.clientX,o=t.clientY;Ut(i,o,a.cmManager.getCommentFromPoint(i-e.left,o-e.top))}),a.commentListContainer[e]("contextmenu",function(t){var e=t.target.parentNode.data;return void 0!=e&&(t.preventDefault(),t.stopPropagation(),void Ut(t.clientX,t.clientY,[e]))}),a.videoDiv.parentNode[e]("touchstart",function(t){if(Yt=!1,t.touches.length>1&&null!=Xt)return clearTimeout(Xt),void(Xt=null);for(var e,i,o,n=[],s=0,l=a.divComment.childNodes.length;s<l;s++)e=a.divComment.childNodes[s].getBoundingClientRect(),i=t.touches[0].clientX-e.left,o=t.touches[0].clientY-e.top,i>=0&&i<=e.width&&o>=0&&o<=e.height&&n.push(a.divComment.childNodes[s]);i=t.touches[0].clientX,o=t.touches[0].clientY,Xt=setTimeout(function(){Xt=null,Yt=!0,Ut(i,o,n)},300)}),a.videoDiv.parentNode[e]("touchmove",function(){null!=Xt&&(clearTimeout(Xt),Xt=null)}),a.videoDiv.parentNode[e]("touchend",function(){null!=Xt&&(clearTimeout(Xt),Xt=null)}),Ht[e]("touchstart",function(t){var e=Ht.getBoundingClientRect();t.touches[0].clientX-e.left<=e.width&&t.touches[0].clientY-e.top<=e.height&&(Yt=!0)});var Jt=function(){a.playerUnit.dispatchEvent(new CustomEvent("saveconfig",{detail:{volume:a.video.volume,opacity:a.cmManager.options.global.opacity,scale:a.commentScale,prop:a.proportionalScale}}))},Qt=function(){var t=new Date,e=""+t.getTime()+Math.random();return""!=a.txtText.value&&!a.txtText.disabled&&(a.playerUnit.dispatchEvent(new CustomEvent("sendcomment",{detail:{id:e,message:a.txtText.value,fontsize:a.commentFontSize,color:parseInt("0x"+a.commentColor),date:t.getFullYear()+"-"+l(t.getMonth())+"-"+l(t.getDay())+" "+l(t.getHours())+":"+l(t.getMinutes())+":"+l(t.getSeconds()),playTime:a.video.currentTime,mode:a.commentMode,pool:0}})),a.cmManager.send({text:a.txtText.value,mode:a.commentMode,stime:a.video.currentTime,size:a.commentFontSize,color:parseInt("0x"+a.commentColor),border:!0}),a.commentList[e]={date:parseInt(t.getTime()/1e3),time:1e3*a.video.currentTime,mode:a.commentMode,user:"-",pool:0,content:a.txtText.value},a.txtText.value="",a.txtText.disabled=!0,void setTimeout(function(){a.txtText.disabled=!1},a.commentCoolDown))};a.txtText.parentNode[e]("submit",function(t){return t.preventDefault(),Qt(),!1}),a.btnSend[e]("click",Qt),a.timeLabel[e]("click",function(){a.timeJump=n("input",{className:"time-jump"}),a.timeJump.value=d(a.video.currentTime),a.controlBar.appendChild(a.timeJump),a.timeJump[e]("blur",function(){a.timeJump&&a.timeJump.parentNode.removeChild(a.timeJump),a.timeJump=null}),a.timeJump[e]("keydown",function(t){if(13==t.keyCode){var e=h(a.timeJump.value);e&&e<=a.video.duration&&(a.video.currentTime=e,a.video.paused&&a.btnPlay.click()),a.timeJump.parentNode.removeChild(a.timeJump)}else(t.keyCode<48||t.keyCode>59)&&(t.keyCode<96||t.keyCode>105)&&8!=t.keyCode&&16!=t.keyCode&&37!=t.keyCode&&39!=t.keyCode&&46!=t.keyCode&&t.preventDefault()}),a.timeJump.focus(),a.timeJump.select()}),a.barTime.style.width="0%",a.barFullScreenTime.style.width="0%";var Gt=!1;a.barTimeHitArea[e]("mousedown",function(t){Gt=!0}),document[e]("mouseup",function(t){if(Gt){var e=y(a.video),i=e.end-e.start,o=(t.clientX-a.barTimeHitArea.getBoundingClientRect().left)/a.barTimeHitArea.offsetWidth*i;o+=e.start,o<0&&(o=0),Math.abs(o-a.video.currentTime)>4&&a.cmManager&&a.cmManager.clear(),a.video.currentTime=o}Gt=!1});var Zt=function(t){var e=y(a.video),i=e.end-e.start,t=t-e.start;a.barTime.style.width=t/i*100+"%",a.barFullScreenTime.style.width=t/i*100+"%",a.timeLabel.innerHTML=d(t)+"/"+d(i)};document[e]("mousemove",function(t){var e=y(a.video),i=e.end,o=(t.clientX-a.barTimeHitArea.getBoundingClientRect().left)/a.barTimeHitArea.offsetWidth*i;o<0&&(o=0),o>i&&(o=i),a.barTimeHitArea.tooltip(d(o)),Gt&&Zt(o)}),u(a.barTimeHitArea,!0,-12);var Kt=!1;a.barVolumeHitArea[e]("mousedown",function(t){Kt=!0});var $t=null,te=function(){$t&&clearTimeout($t),m(i,"volume-show")},ee=function(){$t=setTimeout(function(){f(i,"volume-show")},2e3)};a.barVolumeHitArea[e]("mouseenter",te),a.btnVolume[e]("mouseenter",te),a.barVolumeHitArea[e]("mouseleave",ee),a.btnVolume[e]("mouseleave",ee),a.barVolume.style.width=100*a.video.volume+"%";var ie=function(t){a.barVolume.style.width=100*t+"%",a.video.muted=!1,a.btnVolume.className="button ABP-Volume icon-volume-",t<.1?a.btnVolume.className+="mute":t<.33?a.btnVolume.className+="low":t<.67?a.btnVolume.className+="medium":a.btnVolume.className+="high",a.btnVolume.tooltip(ABP.Strings.mute),a.barVolumeHitArea.tooltip(parseInt(100*t)+"%"),Jt()};document[e]("mouseup",function(t){if(Kt){var e=(t.clientX-a.barVolumeHitArea.getBoundingClientRect().left)/a.barVolumeHitArea.offsetWidth;e<0&&(e=0),e>1&&(e=1),a.video.volume=e,ie(a.video.volume)}Kt=!1}),document[e]("mousemove",function(t){var e=(t.clientX-a.barVolumeHitArea.getBoundingClientRect().left)/a.barVolumeHitArea.offsetWidth;e<0&&(e=0),e>1&&(e=1),Kt?(a.video.volume=e,ie(a.video.volume)):a.barVolumeHitArea.tooltip(parseInt(100*e)+"%")}),u(a.barVolumeHitArea,!0,-12);var oe=!1;a.barOpacityHitArea[e]("mousedown",function(t){oe=!0}),a.barOpacity.style.width=100*a.cmManager.options.global.opacity+"%";var ne=function(t){a.barOpacity.style.width=100*t+"%",a.barOpacityHitArea.tooltip(parseInt(100*t)+"%"),Jt()};document[e]("mouseup",function(t){if(oe){var e=(t.clientX-a.barOpacityHitArea.getBoundingClientRect().left)/a.barOpacityHitArea.offsetWidth;e<0&&(e=0),e>1&&(e=1),a.cmManager.options.global.opacity=e,ne(a.cmManager.options.global.opacity),s.opacity()}oe=!1}),document[e]("mousemove",function(t){var e=(t.clientX-a.barOpacityHitArea.getBoundingClientRect().left)/a.barOpacityHitArea.offsetWidth;e<0&&(e=0),e>1&&(e=1),oe?(a.cmManager.options.global.opacity=e,ne(a.cmManager.options.global.opacity)):a.barOpacityHitArea.tooltip(parseInt(100*e)+"%")}),u(a.barOpacityHitArea,!0,-6);var ae=!1;a.barScaleHitArea[e]("mousedown",function(t){ae=!0}),a.barScale.style.width=(a.commentScale-.2)/1.8*100+"%";var se=function(t){a.barScale.style.width=(t-.2)/1.8*100+"%",a.barScaleHitArea.tooltip(parseInt(100*t)+"%"),a.cmManager.setBounds(),Jt()};document[e]("mouseup",function(t){if(ae){var e=.2+1.8*(t.clientX-a.barScaleHitArea.getBoundingClientRect().left)/a.barScaleHitArea.offsetWidth;e<.2&&(e=.2),e>2&&(e=2),a.commentScale=e,se(a.commentScale),s.scale()}ae=!1}),document[e]("mousemove",function(t){var e=.2+1.8*(t.clientX-a.barScaleHitArea.getBoundingClientRect().left)/a.barScaleHitArea.offsetWidth;e<.2&&(e=.2),e>2&&(e=2),ae?(a.commentScale=e,se(a.commentScale)):a.barScaleHitArea.tooltip(parseInt(100*e)+"%")}),u(a.barScaleHitArea,!0,-6);var le=!1;a.barSpeedHitArea[e]("mousedown",function(t){le=!0}),a.barSpeed.style.width=(a.commentSpeed-.5)/1.5*100+"%";var re=function(t){a.barSpeed.style.width=(t-.5)/1.5*100+"%",a.barSpeedHitArea.tooltip(parseInt(100*t)+"%"),a.cmManager.setBounds(),Jt()};document[e]("mouseup",function(t){if(le){var e=.5+1.5*(t.clientX-a.barSpeedHitArea.getBoundingClientRect().left)/a.barSpeedHitArea.offsetWidth;e<.5&&(e=.5),e>2&&(e=2),a.commentSpeed=e,re(a.commentSpeed),s.speed()}le=!1}),document[e]("mousemove",function(t){var e=.5+1.5*(t.clientX-a.barSpeedHitArea.getBoundingClientRect().left)/a.barSpeedHitArea.offsetWidth;e<.5&&(e=.5),e>2&&(e=2),le?(a.commentSpeed=e,re(a.commentSpeed)):a.barSpeedHitArea.tooltip(parseInt(100*e)+"%")}),u(a.barSpeedHitArea,!0,-6),a.btnPlay[e]("click",function(){a.video.paused?(a.video.play(),this.className="button ABP-Play ABP-Pause icon-pause",this.tooltip(ABP.Strings.pause)):(a.video.pause(),this.className="button ABP-Play icon-play",this.tooltip(ABP.Strings.play))}),i[e]("keydown",function(t){if(t&&"INPUT"!=document.activeElement.tagName)switch([27,32,37,38,39,40].indexOf(t.keyCode)!=-1&&t.preventDefault(),t.keyCode){case 27:abpinst.state.fullscreen&&abpinst.btnFull.click();break;case 32:a.btnPlay.click();break;case 37:var e=a.video.currentTime-=5*a.video.playbackRate;a.cmManager.clear(),e<y(a.video).start&&(e=y(a.video).start),a.video.currentTime=e.toFixed(3),a.video.paused&&a.btnPlay.click(),Zt(g.currentTime),a.barTimeHitArea.tooltip(d(g.currentTime));break;case 39:var e=a.video.currentTime+=5*a.video.playbackRate;a.cmManager.clear(),e>y(a.video).end&&(e=y(a.video).end-1),a.video.currentTime=e.toFixed(3),a.video.paused&&a.btnPlay.click(),Zt(g.currentTime),a.barTimeHitArea.tooltip(d(g.currentTime));break;case 38:var i=a.video.volume+.1;i>1&&(i=1),a.video.volume=i.toFixed(3),ie(a.video.volume);break;case 40:var i=a.video.volume-.1;i<0&&(i=0),a.video.volume=i.toFixed(3),ie(a.video.volume)}}),i[e]("touchmove",function(t){event.preventDefault()});var ce=null;i[e]("touchstart",function(t){p(a.videoDiv,"ABP-HideCursor")&&f(a.videoDiv,"ABP-HideCursor"),t.targetTouches.length>0&&(ce=t.targetTouches[0])}),i[e]("touchend",function(t){if(m(a.videoDiv,"ABP-HideCursor"),t.changedTouches.length>0&&null!=ce){var e=t.changedTouches[0].pageX-ce.pageX,i=t.changedTouches[0].pageY-ce.pageY;if(Math.abs(e)<20&&Math.abs(i)<20)return void(ce=null);Math.abs(e)>3*Math.abs(i)?e>0?a.video.paused&&a.btnPlay.click():a.video.paused||a.btnPlay.click():Math.abs(i)>3*Math.abs(e)&&(i<0?a.video.volume=Math.min(1,a.video.volume+.1):a.video.volume=Math.max(0,a.video.volume-.1)),ce=null}}),i[e]("mouseup",function(){if("INPUT"!=document.activeElement.tagName){var t=window.scrollY;a.videoDiv.focus(),window.scrollTo(window.scrollX,t)}})}if("undefined"!=typeof CommentManager&&a.state.autosize){var de=function(){if(0!==g.videoHeight&&0!==g.videoWidth){var t=g.videoHeight/g.videoWidth,e=i.offsetWidth,o=i.offsetHeight,n=o/e;n<t?(i.style.width=o/t+"px",i.style.height=o+"px"):(i.style.width=e+"px",i.style.height=e*t+"px"),a.cmManager.setBounds()}};g[e]("loadedmetadata",de),de()}return shield.init(a),shield.shield(),dots.init({id:"dots",width:"100%",height:"100%",r:16,thick:4}),a}}}}}}}}}}}}}}}}}}}}}}}}}}})(),function(t){var e=function(){var e='<div class="colpick"><div class="colpick_color"><div class="colpick_color_overlay1"><div class="colpick_color_overlay2"><div class="colpick_selector_outer"><div class="colpick_selector_inner"></div></div></div></div></div><div class="colpick_hue"><div class="colpick_hue_arrs"><div class="colpick_hue_larr"></div><div class="colpick_hue_rarr"></div></div></div><div class="colpick_new_color"></div><div class="colpick_current_color"></div><div class="colpick_hex_field"><div class="colpick_field_letter">#</div><input type="text" maxlength="6" size="6" /></div><div class="colpick_rgb_r colpick_field"><div class="colpick_field_letter">R</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_rgb_g colpick_field"><div class="colpick_field_letter">G</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_rgb_b colpick_field"><div class="colpick_field_letter">B</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_h colpick_field"><div class="colpick_field_letter">H</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_s colpick_field"><div class="colpick_field_letter">S</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_b colpick_field"><div class="colpick_field_letter">B</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_submit"></div></div>',i={showEvent:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},colorScheme:"light",color:"3289c7",livePreview:!0,flat:!1,layout:"full",submit:1,submitText:"OK",height:156},s=function(e,i){var o=a(e);t(i).data("colpick").fields.eq(1).val(o.r).end().eq(2).val(o.g).end().eq(3).val(o.b).end()},r=function(e,i){t(i).data("colpick").fields.eq(4).val(Math.round(e.h)).end().eq(5).val(Math.round(e.s)).end().eq(6).val(Math.round(e.b)).end()},c=function(e,i){t(i).data("colpick").fields.eq(0).val(l(e))},d=function(e,i){t(i).data("colpick").selector.css("backgroundColor","#"+l({h:e.h,s:100,b:100})),t(i).data("colpick").selectorIndic.css({left:parseInt(t(i).data("colpick").height*e.s/100,10),top:parseInt(t(i).data("colpick").height*(100-e.b)/100,10)})},h=function(e,i){t(i).data("colpick").hue.css("top",parseInt(t(i).data("colpick").height-t(i).data("colpick").height*e.h/360,10))},u=function(e,i){t(i).data("colpick").currentColor.css("backgroundColor","#"+l(e))},m=function(e,i){t(i).data("colpick").newColor.css("backgroundColor","#"+l(e))},p=function(e){var i,u=t(this).parent().parent();this.parentNode.className.indexOf("_hex")>0?(u.data("colpick").color=i=o(L(this.value)),s(i,u.get(0)),r(i,u.get(0))):this.parentNode.className.indexOf("_hsb")>0?(u.data("colpick").color=i=T({h:parseInt(u.data("colpick").fields.eq(4).val(),10),s:parseInt(u.data("colpick").fields.eq(5).val(),10),b:parseInt(u.data("colpick").fields.eq(6).val(),10)}),s(i,u.get(0)),c(i,u.get(0))):(u.data("colpick").color=i=n(M({r:parseInt(u.data("colpick").fields.eq(1).val(),10),g:parseInt(u.data("colpick").fields.eq(2).val(),10),b:parseInt(u.data("colpick").fields.eq(3).val(),10)})),c(i,u.get(0)),r(i,u.get(0))),d(i,u.get(0)),h(i,u.get(0)),m(i,u.get(0)),u.data("colpick").onChange.apply(u.parent(),[i,l(i),a(i),u.data("colpick").el,0])},f=function(e){t(this).parent().removeClass("colpick_focus")},v=function(){t(this).parent().parent().data("colpick").fields.parent().removeClass("colpick_focus"),t(this).parent().addClass("colpick_focus")},g=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;var i=t(this).parent().find("input").focus(),o={el:t(this).parent().addClass("colpick_slider"),max:this.parentNode.className.indexOf("_hsb_h")>0?360:this.parentNode.className.indexOf("_hsb")>0?100:255,y:e.pageY,field:i,val:parseInt(i.val(),10),preview:t(this).parent().parent().data("colpick").livePreview};t(document).mouseup(o,b),t(document).mousemove(o,y)},y=function(t){return t.data.field.val(Math.max(0,Math.min(t.data.max,parseInt(t.data.val-t.pageY+t.data.y,10)))),t.data.preview&&p.apply(t.data.field.get(0),[!0]),!1},b=function(e){return p.apply(e.data.field.get(0),[!0]),e.data.el.removeClass("colpick_slider").find("input").focus(),t(document).off("mouseup",b),t(document).off("mousemove",y),!1},x=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;var i={cal:t(this).parent(),y:t(this).offset().top};t(document).on("mouseup touchend",i,w),t(document).on("mousemove touchmove",i,S);var o="touchstart"==e.type?e.originalEvent.changedTouches[0].pageY:e.pageY;return p.apply(i.cal.data("colpick").fields.eq(4).val(parseInt(360*(i.cal.data("colpick").height-(o-i.y))/i.cal.data("colpick").height,10)).get(0),[i.cal.data("colpick").livePreview]),!1},S=function(t){var e="touchmove"==t.type?t.originalEvent.changedTouches[0].pageY:t.pageY;return p.apply(t.data.cal.data("colpick").fields.eq(4).val(parseInt(360*(t.data.cal.data("colpick").height-Math.max(0,Math.min(t.data.cal.data("colpick").height,e-t.data.y)))/t.data.cal.data("colpick").height,10)).get(0),[t.data.preview]),!1},w=function(e){return s(e.data.cal.data("colpick").color,e.data.cal.get(0)),c(e.data.cal.data("colpick").color,e.data.cal.get(0)),t(document).off("mouseup touchend",w),t(document).off("mousemove touchmove",S),!1},C=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;var i={cal:t(this).parent(),pos:t(this).offset()};i.preview=i.cal.data("colpick").livePreview,t(document).on("mouseup touchend",i,_),t(document).on("mousemove touchmove",i,k);var o;return"touchstart"==e.type?(pageX=e.originalEvent.changedTouches[0].pageX,o=e.originalEvent.changedTouches[0].pageY):(pageX=e.pageX,o=e.pageY),p.apply(i.cal.data("colpick").fields.eq(6).val(parseInt(100*(i.cal.data("colpick").height-(o-i.pos.top))/i.cal.data("colpick").height,10)).end().eq(5).val(parseInt(100*(pageX-i.pos.left)/i.cal.data("colpick").height,10)).get(0),[i.preview]),!1},k=function(t){var e;return"touchmove"==t.type?(pageX=t.originalEvent.changedTouches[0].pageX,e=t.originalEvent.changedTouches[0].pageY):(pageX=t.pageX,e=t.pageY),p.apply(t.data.cal.data("colpick").fields.eq(6).val(parseInt(100*(t.data.cal.data("colpick").height-Math.max(0,Math.min(t.data.cal.data("colpick").height,e-t.data.pos.top)))/t.data.cal.data("colpick").height,10)).end().eq(5).val(parseInt(100*Math.max(0,Math.min(t.data.cal.data("colpick").height,pageX-t.data.pos.left))/t.data.cal.data("colpick").height,10)).get(0),[t.data.preview]),!1},_=function(e){return s(e.data.cal.data("colpick").color,e.data.cal.get(0)),c(e.data.cal.data("colpick").color,e.data.cal.get(0)),t(document).off("mouseup touchend",_),t(document).off("mousemove touchmove",k),!1},A=function(e){var i=t(this).parent(),o=i.data("colpick").color;i.data("colpick").origColor=o,u(o,i.get(0)),i.data("colpick").onSubmit(o,l(o),a(o),i.data("colpick").el)},P=function(e){e.stopPropagation();var i=t("#"+t(this).data("colpickId"));i.data("colpick").onBeforeShow.apply(this,[i.get(0)]);var o=t(this).offset(),n=o.top+this.offsetHeight,a=o.left,s=N(),l=i.width();a+l>s.l+s.w&&(a-=l),i.css({left:a+"px",top:n+"px"}),0!=i.data("colpick").onShow.apply(this,[i.get(0)])&&i.show(),t("html").mousedown({cal:i},B),i.mousedown(function(t){t.stopPropagation()})},B=function(e){0!=e.data.cal.data("colpick").onHide.apply(this,[e.data.cal.get(0)])&&e.data.cal.hide(),t("html").off("mousedown",B)},N=function(){var t="CSS1Compat"==document.compatMode;return{l:window.pageXOffset||(t?document.documentElement.scrollLeft:document.body.scrollLeft),w:window.innerWidth||(t?document.documentElement.clientWidth:document.body.clientWidth)}},T=function(t){return{h:Math.min(360,Math.max(0,t.h)),s:Math.min(100,Math.max(0,t.s)),b:Math.min(100,Math.max(0,t.b))}},M=function(t){return{r:Math.min(255,Math.max(0,t.r)),g:Math.min(255,Math.max(0,t.g)),b:Math.min(255,Math.max(0,t.b))}},L=function(t){var e=6-t.length;if(e>0){for(var i=[],o=0;o<e;o++)i.push("0");i.push(t),t=i.join("")}return t},F=function(){var e=t(this).parent(),i=e.data("colpick").origColor;e.data("colpick").color=i,s(i,e.get(0)),c(i,e.get(0)),r(i,e.get(0)),d(i,e.get(0)),h(i,e.get(0)),m(i,e.get(0))};return{init:function(a){if(a=t.extend({},i,a||{}),"string"==typeof a.color)a.color=o(a.color);else if(void 0!=a.color.r&&void 0!=a.color.g&&void 0!=a.color.b)a.color=n(a.color);else{if(void 0==a.color.h||void 0==a.color.s||void 0==a.color.b)return this;a.color=T(a.color)}return this.each(function(){if(!t(this).data("colpickId")){var i=t.extend({},a);i.origColor=a.color;var o="collorpicker_"+parseInt(1e3*Math.random());t(this).data("colpickId",o);var n=t(e).attr("id",o);n.addClass("colpick_"+i.layout+(i.submit?"":" colpick_"+i.layout+"_ns")),"light"!=i.colorScheme&&n.addClass("colpick_"+i.colorScheme),n.find("div.colpick_submit").html(i.submitText).click(A),i.fields=n.find("input").change(p).blur(f).focus(v),n.find("div.colpick_field_arrs").mousedown(g).end().find("div.colpick_current_color").click(F),i.selector=n.find("div.colpick_color").on("mousedown touchstart",C),i.selectorIndic=i.selector.find("div.colpick_selector_outer"),i.el=this,i.hue=n.find("div.colpick_hue_arrs"),huebar=i.hue.parent();var l=navigator.userAgent.toLowerCase(),y="Microsoft Internet Explorer"===navigator.appName,b=y?parseFloat(l.match(/msie ([0-9]{1,}[\.0-9]{0,})/)[1]):0,S=y&&b<10,w=["#ff0000","#ff0080","#ff00ff","#8000ff","#0000ff","#0080ff","#00ffff","#00ff80","#00ff00","#80ff00","#ffff00","#ff8000","#ff0000"];if(S){var k,_;for(k=0;k<=11;k++)_=t("<div></div>").attr("style","height:8.333333%; filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr="+w[k]+", endColorstr="+w[k+1]+'); -ms-filter: "progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr='+w[k]+", endColorstr="+w[k+1]+')";'),huebar.append(_)}else stopList=w.join(","),huebar.attr("style","background:-webkit-linear-gradient(top,"+stopList+"); background: -o-linear-gradient(top,"+stopList+"); background: -ms-linear-gradient(top,"+stopList+"); background:-moz-linear-gradient(top,"+stopList+"); -webkit-linear-gradient(top,"+stopList+"); background:linear-gradient(to bottom,"+stopList+"); ");n.find("div.colpick_hue").on("mousedown touchstart",x),i.newColor=n.find("div.colpick_new_color"),i.currentColor=n.find("div.colpick_current_color"),n.data("colpick",i),s(i.color,n.get(0)),r(i.color,n.get(0)),c(i.color,n.get(0)),h(i.color,n.get(0)),d(i.color,n.get(0)),u(i.color,n.get(0)),m(i.color,n.get(0)),i.flat?(n.appendTo(this).show(),n.css({position:"relative",display:"block"})):(n.appendTo(document.body),t(this).on(i.showEvent,P),n.css({position:"absolute"}))}})},showPicker:function(){return this.each(function(){t(this).data("colpickId")&&P.apply(this)})},hidePicker:function(){return this.each(function(){t(this).data("colpickId")&&t("#"+t(this).data("colpickId")).hide()})},setColor:function(e,i){if(i="undefined"==typeof i?1:i,"string"==typeof e)e=o(e);else if(void 0!=e.r&&void 0!=e.g&&void 0!=e.b)e=n(e);else{if(void 0==e.h||void 0==e.s||void 0==e.b)return this;e=T(e)}return this.each(function(){if(t(this).data("colpickId")){var o=t("#"+t(this).data("colpickId"));o.data("colpick").color=e,o.data("colpick").origColor=e,s(e,o.get(0)),r(e,o.get(0)),c(e,o.get(0)),h(e,o.get(0)),d(e,o.get(0)),m(e,o.get(0)),o.data("colpick").onChange.apply(o.parent(),[e,l(e),a(e),o.data("colpick").el,1]),i&&u(e,o.get(0))}})}}}(),i=function(t){var t=parseInt(t.indexOf("#")>-1?t.substring(1):t,16);return{r:t>>16,g:(65280&t)>>8,b:255&t}},o=function(t){return n(i(t))},n=function(t){var e={h:0,s:0,b:0},i=Math.min(t.r,t.g,t.b),o=Math.max(t.r,t.g,t.b),n=o-i;return e.b=o,e.s=0!=o?255*n/o:0,0!=e.s?t.r==o?e.h=(t.g-t.b)/n:t.g==o?e.h=2+(t.b-t.r)/n:e.h=4+(t.r-t.g)/n:e.h=-1,
e.h*=60,e.h<0&&(e.h+=360),e.s*=100/255,e.b*=100/255,e},a=function(t){var e={},i=t.h,o=255*t.s/100,n=255*t.b/100;if(0==o)e.r=e.g=e.b=n;else{var a=n,s=(255-o)*n/255,l=(a-s)*(i%60)/60;360==i&&(i=0),i<60?(e.r=a,e.b=s,e.g=s+l):i<120?(e.g=a,e.b=s,e.r=a-l):i<180?(e.g=a,e.r=s,e.b=s+l):i<240?(e.b=a,e.r=s,e.g=a-l):i<300?(e.b=a,e.g=s,e.r=s+l):i<360?(e.r=a,e.g=s,e.b=a-l):(e.r=0,e.g=0,e.b=0)}return{r:Math.round(e.r),g:Math.round(e.g),b:Math.round(e.b)}},s=function(e){var i=[e.r.toString(16),e.g.toString(16),e.b.toString(16)];return t.each(i,function(t,e){1==e.length&&(i[t]="0"+e)}),i.join("")},l=function(t){return s(a(t))};t.fn.extend({colpick:e.init,colpickHide:e.hidePicker,colpickShow:e.showPicker,colpickSetColor:e.setColor}),t.extend({colpick:{rgbToHex:s,rgbToHsb:n,hsbToHex:l,hsbToRgb:a,hexToHsb:o,hexToRgb:i}})}(jQuery);